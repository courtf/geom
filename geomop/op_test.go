package geomop

import (
	"fmt"
	"github.com/foobaz/geom"
	"github.com/foobaz/geom/carto"
	"github.com/foobaz/geom/encoding/wkt"
	"image/color"
	"math"
	"math/rand"
	"os"
	"testing"
	"time"
)

var shape1, shape2 geom.T

func init() {
	shape1 = geom.Polygon{{geom.Point{0, 0}, geom.Point{1, 0},
		geom.Point{1, 1}, geom.Point{0, 1}, geom.Point{0, 0}}}
	shape2 = geom.Polygon{{geom.Point{.25, .25},
		geom.Point{.75, .25}, geom.Point{.75, .75}, geom.Point{.25, .75},
		geom.Point{.25, .25}}}
}

func TestArea(t *testing.T) {
	a := Area(shape1)
	if different(a, 1.) {
		t.Log(a)
		t.Fail()
	}
	a = Area(shape2)
	if different(a, 0.25) {
		t.Log(a)
		t.Fail()
	}
}

func TestDifference(t *testing.T) {
	FixOrientation(shape1)
	FixOrientation(shape2)
	shape := Construct(shape1, shape2, DIFFERENCE)
	t.Log(shape)
	a := Area(shape)
	if different(a, 0.75) {
		t.Log(a)
		t.Fail()
	}
	drawShapes(shape2, shape1, shape, "difference.png")
}

func TestUnion(t *testing.T) {
	shape := Construct(shape1, shape2, UNION)
	t.Log(shape)
	a := Area(shape)
	if different(a, 1.) {
		t.Log(a)
		t.Fail()
	}
	drawShapes(shape2, shape1, shape, "union.png")
}

func TestIntersection(t *testing.T) {
	shape := Construct(shape1, shape2, INTERSECTION)
	t.Log(shape)
	a := Area(shape)
	if different(a, 0.25) {
		t.Log(a)
		t.Fail()
	}
	drawShapes(shape2, shape1, shape, "intersection.png")
}

func TestXor(t *testing.T) {
	shape := Construct(shape1, shape2, XOR)
	t.Log(shape)
	a := Area(shape)
	if different(a, 0.75) {
		t.Log(a)
		t.Fail()
	}
	drawShapes(shape2, shape1, shape, "xor.png")
}

func TestDifficultShapes1(t *testing.T) {
	difficultShapeA := geom.T(geom.Polygon{{
		{-949.9671190511435, -776530.876383242}, {-971.3149450758938, -776530.876383242},
		{-987.3186852218928, -776530.876383242}, {-971.3143310546875, -776530.9375},
		{-949.9663696289062, -776530.9375}, {-932.567192575676, -776530.876383242}},
		{{-400.82663417423987, -776530.9375}, {-914.386962890625, -776530.9375},
			{-931.7797537201152, -776530.876383242}, {-914.3856589011848, -776530.876383242}},
		{{1847.9894266200718, -776543.8761907278}, {1828.7784833281767, -776543.4981672468},
			{1449.5499414053597, -776539.7180058745}, {1828.78173828125, -776543.5625},
			{1847.9920654296875, -776543.9375}, {1870.3248060378032, -776543.8761907278}},
		{{1892.1079170496669, -776544.3119677962}, {1871.1446207564968, -776543.8840402034},
			{1892.11181640625, -776544.375}, {1906.2987491577942, -776544.5347901696}},
		{{2237.068105247765, -776547.7454548368}, {2225.847412109375, -776547.625},
			{2225.844897193834, -776547.6249235813}}})

	difficultShapeB := geom.T(geom.Polygon{{
		{-4000, -780000}, {-4000, -776000}, {0, -776000}, {0, -780000}, {-4000, -780000}}})
	FixOrientation(difficultShapeA)
	FixOrientation(difficultShapeB)

	solution := Construct(difficultShapeA, difficultShapeB, INTERSECTION)
	drawShapes(difficultShapeA, difficultShapeB, solution, "DifficultShapes1.png")
	t.Log(Area(solution))
}

func TestDifficultShapes2(t *testing.T) {
	shape := geom.T(geom.Polygon{
		{{1.825033375e+06, -277681.0625}, {1.824031125e+06, -277704.15625},
			{1.823029e+06, -277727.21875}, {1.82202675e+06, -277750.28125},
			{1.822009375e+06, -276760.3125}, {1.8230115e+06, -276737.25},
			{1.822994e+06, -275747.28125}, {1.821991875e+06, -275770.34375},
			{1.821974375e+06, -274780.4375}, {1.822976625e+06, -274757.34375},
			{1.82397875e+06, -274734.28125}, {1.82396125e+06, -273744.34375},
			{1.822959125e+06, -273767.4375}, {1.822941625e+06, -272777.53125},
			{1.822924125e+06, -271787.625}, {1.822906625e+06, -270797.75},
			{1.823908875e+06, -270774.65625}, {1.823891375e+06, -269784.78125},
			{1.8248935e+06, -269761.6875}, {1.824911e+06, -270751.5625},
			{1.825913125e+06, -270728.46875}, {1.825930625e+06, -271718.34375},
			{1.82693275e+06, -271695.25}, {1.82691525e+06, -270705.34375},
			{1.82689775e+06, -269715.46875}, {1.826880375e+06, -268725.59375},
			{1.825878125e+06, -268748.71875}, {1.82587775e+06, -268727.3125},
			{1.8264545e+06, -268620.5625}, {1.826543375e+06, -268605.375},
			{1.82657925e+06, -268598.875}, {1.827439125e+06, -268449.4375},
			{1.82787675e+06, -268378.90625}, {1.8278825e+06, -268702.46875},
			{1.8279e+06, -269692.34375}, {1.828902125e+06, -269669.21875},
			{1.828919625e+06, -270659.09375}, {1.82992175e+06, -270635.96875},
			{1.82993925e+06, -271625.875}, {1.830941375e+06, -271602.75},
			{1.831943625e+06, -271579.59375}, {1.831961125e+06, -272569.53125},
			{1.83296325e+06, -272546.375}, {1.83298075e+06, -273536.34375},
			{1.83299825e+06, -274526.28125}, {1.83301575e+06, -275516.28125},
			{1.83303325e+06, -276506.25}, {1.833050875e+06, -277496.25},
			{1.834053e+06, -277473.125}, {1.83505525e+06, -277450},
			{1.835037625e+06, -276460}, {1.835020125e+06, -275470},
			{1.83602225e+06, -275446.84375}, {1.83600475e+06, -274456.84375},
			{1.837007e+06, -274433.6875}, {1.838009125e+06, -274410.53125},
			{1.83901125e+06, -274387.375}, {1.8400135e+06, -274364.1875},
			{1.841015625e+06, -274341}, {1.84201775e+06, -274317.8125},
			{1.84302e+06, -274294.625}, {1.8430375e+06, -275284.625},
			{1.842035375e+06, -275307.8125}, {1.842052875e+06, -276297.84375},
			{1.84105075e+06, -276321.03125}, {1.84106825e+06, -277311.0625},
			{1.841085875e+06, -278301.125}, {1.841103375e+06, -279291.1875},
			{1.841121e+06, -280281.28125}, {1.84011875e+06, -280304.4375},
			{1.840136375e+06, -281294.53125}, {1.839134125e+06, -281317.6875},
			{1.839116625e+06, -280327.59375}, {1.839099e+06, -279337.5},
			{1.8390815e+06, -278347.4375}, {1.839063875e+06, -277357.40625},
			{1.83806175e+06, -277380.5625}, {1.83807925e+06, -278370.59375},
			{1.837077125e+06, -278393.75}, {1.836074875e+06, -278416.90625},
			{1.8360925e+06, -279406.9375}, {1.83509025e+06, -279430.0625},
			{1.83510775e+06, -280420.125}, {1.83611e+06, -280397},
			{1.8361275e+06, -281387.09375}, {1.835125375e+06, -281410.21875},
			{1.834123125e+06, -281433.34375}, {1.833121e+06, -281456.4375},
			{1.833103375e+06, -280466.375}, {1.834105625e+06, -280443.25},
			{1.834088125e+06, -279453.1875}, {1.833085875e+06, -279476.3125},
			{1.833068375e+06, -278486.28125}, {1.832066125e+06, -278509.40625},
			{1.83208375e+06, -279499.4375}, {1.8310815e+06, -279522.53125},
			{1.831099e+06, -280512.59375}, {1.8311165e+06, -281502.65625},
			{1.830114375e+06, -281525.75}, {1.830096875e+06, -280535.6875},
			{1.83007925e+06, -279545.65625}, {1.83006175e+06, -278555.625},
			{1.829059625e+06, -278578.71875}, {1.829042125e+06, -277588.71875},
			{1.828039875e+06, -277611.8125}, {1.828057375e+06, -278601.8125},
			{1.828074875e+06, -279591.84375}, {1.82707275e+06, -279614.90625},
			{1.82705525e+06, -278624.90625}, {1.826053e+06, -278648},
			{1.825050875e+06, -278671.0625}, {1.825033375e+06, -277681.0625}},
		{{1.82396125e+06, -273744.34375}, {1.824963375e+06, -273721.25},
			{1.824946e+06, -272731.34375}, {1.8249285e+06, -271741.4375},
			{1.82392625e+06, -271764.53125}, {1.82394375e+06, -272754.4375},
			{1.82396125e+06, -273744.34375}},
		{{1.837042e+06, -276413.6875}, {1.836039875e+06, -276436.84375},
			{1.836057375e+06, -277426.875}, {1.837059625e+06, -277403.71875},
			{1.837042e+06, -276413.6875}},
		{{1.837042e+06, -276413.6875}, {1.83804425e+06, -276390.53125},
			{1.838026625e+06, -275400.53125}, {1.8370245e+06, -275423.6875},
			{1.837042e+06, -276413.6875}},
		{{1.825033375e+06, -277681.0625}, {1.8260355e+06, -277658},
			{1.826018e+06, -276668}, {1.825015875e+06, -276691.09375},
			{1.825033375e+06, -277681.0625}},
		{{1.82993925e+06, -271625.875}, {1.828937125e+06, -271649},
			{1.828954625e+06, -272638.90625}, {1.82995675e+06, -272615.78125},
			{1.82993925e+06, -271625.875}},
		{{1.828004875e+06, -275631.84375}, {1.827987375e+06, -274641.90625},
			{1.827969875e+06, -273651.96875}, {1.82696775e+06, -273675.0625},
			{1.82698525e+06, -274665}, {1.82700275e+06, -275654.96875},
			{1.828004875e+06, -275631.84375}},
		{{1.8260005e+06, -275678.03125}, {1.825983125e+06, -274688.09375},
			{1.824980875e+06, -274711.1875}, {1.824998375e+06, -275701.125},
			{1.8260005e+06, -275678.03125}},
		{{1.832031125e+06, -276529.375}, {1.832013625e+06, -275539.40625},
			{1.831011375e+06, -275562.53125}, {1.83000925e+06, -275585.625},
			{1.83002675e+06, -276575.625}, {1.831029e+06, -276552.5},
			{1.832031125e+06, -276529.375}}})

	b := shape.Bounds(nil)
	bounds := geom.T(geom.Polygon{{
		{b.Min[0], b.Min[1]}, {b.Max[0], b.Min[1]}, {b.Max[0], b.Max[1]},
		{b.Min[0], b.Max[1]}, {b.Min[0], b.Min[1]}}})
	FixOrientation(shape)
	FixOrientation(bounds)
	intersection := Construct(shape, bounds, INTERSECTION)
	if different(Area(intersection), Area(shape)) {
		t.Fail()
		t.Log(Area(intersection), Area(shape))
	}
	drawShapes(bounds, shape, intersection, "DifficultShapes2.png")
}

func TestDifficultShapes4(t *testing.T) {
	a := geom.T(geom.Polygon{
		{{-1.05479925e+06, 357453.593}, {-1.05279975e+06, 357459.593}, {-1.05280525e+06, 358450.906}, {-1.0518055e+06, 358453.906}, {-1.051811e+06, 359445.25}, {-1.0518165e+06, 360436.593}, {-1.051822e+06, 361427.968}, {-1.052821875e+06, 361424.937}, {-1.05281625e+06, 360433.562}, {-1.05281075e+06, 359442.218}, {-1.053810625e+06, 359439.218}, {-1.054810375e+06, 359436.218}, {-1.054815875e+06, 360427.562}, {-1.055815625e+06, 360424.562}, {-1.0568155e+06, 360421.562}, {-1.05681e+06, 359430.218}, {-1.055810125e+06, 359433.218}, {-1.055804625e+06, 358441.906}, {-1.054804875e+06, 358444.906}, {-1.05479925e+06, 357453.593}}})
	b := geom.T(geom.Polygon{
		{{-1.08e+06, 324000}, {-1.08e+06, 360000}, {-1.044e+06, 360000}, {-1.044e+06, 324000}, {-1.08e+06, 324000}}})

	FixOrientation(a)
	FixOrientation(b)

	intersection := Construct(a, b, INTERSECTION)
	diff := Construct(a, b, DIFFERENCE)
	if different(Area(a), Area(intersection)+Area(diff)) {
		t.Fail()
		t.Log(Area(a), Area(intersection)+Area(diff))
	}
	drawShapes(b, a, intersection, "DifficultShapes4.png")
	drawShapes(b, a, diff, "DifficultShapes4diff.png")
}

// This test, where 2 points are almost exactly the same, doesn't
// end up working correctly (The result is empty but it should
// contain the entire shape a).
func TestDifficultShapes5(t *testing.T) {
	a := geom.T(geom.Polygon{
		{{0, 0}, {1, 0}, {0.5, 0.5}, {1, 1}, {0, 1}, {0, 0}}})
	b := geom.T(geom.Polygon{
		{{1, 0}, {1, 1}, {0.5, 0.5 * (1 + 1e-10)}, {1, 0}}})

	FixOrientation(a)
	FixOrientation(b)

	intersection := Construct(a, b, INTERSECTION)
	diff := Construct(a, b, DIFFERENCE)
	drawShapes(b, a, intersection, "DifficultShapes5.png")
	drawShapes(b, a, diff, "DifficultShapes5diff.png")
	s, _ := wkt.Encode(diff, geom.TwoD)
	fmt.Println(string(s))
}

func TestDifficultShapes6(t *testing.T) {
	a := geom.T(geom.Polygon{
		{{1.297619625e+06, -227351.828125}, {1.297598375e+06, -227384.40625}, {1.297586875e+06, -227385.421875}, {1.297546625e+06, -227402.703125}, {1.297512875e+06, -227446.734375}, {1.297499375e+06, -227464.34375}, {1.297445625e+06, -227495.375}, {1.297398875e+06, -227514.15625}, {1.2973705e+06, -227545.3125}, {1.29734675e+06, -227562.890625}, {1.297324125e+06, -227566.59375}, {1.2973085e+06, -227563.171875}, {1.297281e+06, -227520.609375}, {1.297261875e+06, -227503.640625}, {1.297243375e+06, -227495.109375}, {1.29720725e+06, -227478.796875}, {1.297154125e+06, -227467.796875}, {1.2971095e+06, -227457.984375}, {1.2970945e+06, -227470.296875}, {1.297078375e+06, -227513.984375}, {1.297056375e+06, -227554.8125}, {1.29702875e+06, -227573.875}, {1.297003625e+06, -227604.484375}, {1.2969575e+06, -227598.34375}, {1.296931125e+06, -227578.71875}, {1.296919125e+06, -227547.3125}, {1.296920375e+06, -227513.3125}, {1.296903875e+06, -227479.234375}, {1.29688375e+06, -227451.734375}, {1.296831875e+06, -227439.6875}, {1.2967925e+06, -227411.921875}, {1.296731625e+06, -227353.421875}, {1.296695625e+06, -227300.703125}, {1.2966365e+06, -227231.671875}, {1.29660725e+06, -227215.09375}, {1.2965655e+06, -227214.65625}, {1.296534125e+06, -227215.484375}, {1.2964935e+06, -227188.765625}, {1.296433875e+06, -227166.453125}, {1.296387e+06, -227159.984375}, {1.2963125e+06, -227138.8125}, {1.296271e+06, -227118.671875}, {1.29624775e+06, -227076.703125}, {1.296235625e+06, -227019.640625}, {1.29623975e+06, -226981.765625}, {1.29623475e+06, -226959.90625}, {1.29621475e+06, -226937.9375}, {1.29617625e+06, -226923.71875}, {1.296152375e+06, -226898.953125}, {1.29612e+06, -226893.546875}, {1.29607725e+06, -226874.453125}, {1.29604375e+06, -226836.71875}, {1.2960075e+06, -226781.921875}, {1.29598e+06, -226717.984375}, {1.29595375e+06, -226666.234375}, {1.295949875e+06, -226659.59375}, {1.29590925e+06, -226598.671875}, {1.295885875e+06, -226560.140625}, {1.295815125e+06, -226512.25}, {1.2957805e+06, -226504.65625}, {1.2957445e+06, -226493.4375}, {1.295693375e+06, -226448.734375}, {1.295661875e+06, -226452.1875}, {1.295632e+06, -226478.03125}, {1.2956175e+06, -226494.09375}, {1.295600875e+06, -226534.859375}, {1.29558375e+06, -226567.609375}, {1.29554975e+06, -226594.125}, {1.29550975e+06, -226603.671875}, {1.2954675e+06, -226616.984375}, {1.295446625e+06, -226631.9375}, {1.29543475e+06, -226663.8125}, {1.295391625e+06, -226696.53125}, {1.29535675e+06, -226717.203125}, {1.295273125e+06, -226815.5625}, {1.295204875e+06, -226828.4375}, {1.29518075e+06, -226814.828125}, {1.295112375e+06, -226839.6875}, {1.29509825e+06, -226849.265625}, {1.295088375e+06, -226872.6875}, {1.295061625e+06, -226905.71875}, {1.295047e+06, -226920.09375}, {1.29501025e+06, -226938.0625}, {1.29495425e+06, -226938.234375}, {1.294891125e+06, -226940.84375}, {1.2948605e+06, -226941.15625}, {1.294825375e+06, -226927.203125}, {1.294805625e+06, -226931.71875}, {1.294787875e+06, -226944.453125}, {1.294777375e+06, -226959.859375}, {1.294761375e+06, -226966.3125}, {1.29474625e+06, -226978.203125}, {1.294740625e+06, -226997.953125}, {1.294731e+06, -227001.65625}, {1.29467225e+06, -227047.609375}, {1.29465575e+06, -227060.125}, {1.294627e+06, -227146.96875}, {1.294591e+06, -227194.328125}, {1.2945715e+06, -227209.0625}, {1.29455225e+06, -227228.890625}, {1.294515125e+06, -227249.046875}, {1.294505625e+06, -227266.015625}, {1.294509875e+06, -227300.390625}, {1.294502e+06, -227323.484375}, {1.294482125e+06, -227327.15625}, {1.2944545e+06, -227341.9375}, {1.29444525e+06, -227340.015625}, {1.29443075e+06, -227347.09375}, {1.294419625e+06, -227362.609375}, {1.29439675e+06, -227402.6875}, {1.29437725e+06, -227446.09375}, {1.294364625e+06, -227473.796875}, {1.294326375e+06, -227498.875}, {1.294307875e+06, -227527.5625}, {1.294304125e+06, -227609.015625}, {1.294282875e+06, -227630.015625}, {1.29427425e+06, -227639.96875}, {1.294257875e+06, -227648.21875}, {1.294241125e+06, -227671.0625}, {1.29424775e+06, -227699.0625}, {1.2942425e+06, -227721.71875}, {1.294192875e+06, -227756.765625}, {1.294176125e+06, -227767.203125}, {1.294126e+06, -227819.875}, {1.294113e+06, -227832.265625}, {1.294066125e+06, -227883.96875}, {1.294041875e+06, -227911.03125}, {1.29400275e+06, -227939.640625}, {1.293959875e+06, -227991.125}, {1.293951875e+06, -228000.140625}, {1.293710375e+06, -228258.109375}, {1.293510125e+06, -228471.28125}, {1.29344075e+06, -228544.203125}, {1.29320075e+06, -228795.046875}, {1.293183875e+06, -228812.78125}, {1.29317625e+06, -228820.859375}, {1.2929615e+06, -229045.375}, {1.292634375e+06, -229386.546875}, {1.292537375e+06, -229487.46875}, {1.29246675e+06, -229561.421875}, {1.29221625e+06, -229822.953125}, {1.2916205e+06, -230452.9375}, {1.291534125e+06, -230543.5625}, {1.291639875e+06, -230735.484375}, {1.292019125e+06, -231419.171875}, {1.292043125e+06, -231461.875}, {1.292296125e+06, -231919.375}, {1.292724875e+06, -232692.09375}, {1.2927645e+06, -232763.46875}, {1.293169375e+06, -233493.890625}, {1.293204125e+06, -233556.640625}, {1.293223375e+06, -233590.71875}, {1.293528375e+06, -234140.234375}, {1.293550625e+06, -234180.640625}, {1.293795875e+06, -234623.546875}, {1.29393775e+06, -234876.734375}, {1.294013875e+06, -235017}, {1.294371875e+06, -235660.09375}, {1.294432875e+06, -235769.90625}, {1.294571e+06, -236013.40625}, {1.2946505e+06, -236152.71875}, {1.294668875e+06, -236185.640625}, {1.29480525e+06, -236438.859375}, {1.294816375e+06, -236398.109375}, {1.294890625e+06, -236303.875}, {1.2950095e+06, -236193.8125}, {1.295035e+06, -236169.96875}, {1.295146125e+06, -236079.546875}, {1.2952155e+06, -236022.46875}, {1.295385125e+06, -235842.90625}, {1.295405e+06, -235822.140625}, {1.295455375e+06, -235782.6875}, {1.295690625e+06, -235598.421875}, {1.295737125e+06, -235560.875}, {1.29591e+06, -235421.4375}, {1.295918875e+06, -235417}, {1.295971e+06, -235388.390625}, {1.296038875e+06, -235364.46875}, {1.2961485e+06, -235349.125}, {1.296171875e+06, -235337.59375}, {1.296180875e+06, -235313.03125}, {1.296180125e+06, -235274.671875}, {1.296130875e+06, -235186.890625}, {1.2960765e+06, -235088}, {1.29605325e+06, -235046.4375}, {1.29603975e+06, -235009.734375}, {1.296026375e+06, -234973.84375}, {1.296007375e+06, -234828.09375}, {1.296043375e+06, -234781.140625}, {1.29607775e+06, -234748.15625}, {1.296085375e+06, -234740.921875}, {1.29615525e+06, -234716.671875}, {1.29622925e+06, -234717.40625}, {1.296301e+06, -234733.921875}, {1.2963545e+06, -234763.6875}, {1.2964625e+06, -234876.921875}, {1.2965415e+06, -234920.484375}, {1.296617125e+06, -234931.21875}, {1.296655e+06, -234912.1875}, {1.296678375e+06, -234854.46875}, {1.296664625e+06, -234782.3125}, {1.296623375e+06, -234714.1875}, {1.296569875e+06, -234625.828125}, {1.29657075e+06, -234584.625}, {1.2965795e+06, -234559.234375}, {1.296589875e+06, -234530.171875}, {1.296590125e+06, -234519.421875}, {1.296591125e+06, -234504.296875}, {1.296502125e+06, -234390.953125}, {1.296496125e+06, -234383.796875}, {1.296491e+06, -234376.953125}, {1.296354625e+06, -234157.96875}, {1.2962795e+06, -234036.796875}, {1.296237625e+06, -233977.34375}, {1.296223125e+06, -233955.75}, {1.296194625e+06, -233939.890625}, {1.296143875e+06, -233863.90625}, {1.2960625e+06, -233771.5625}, {1.296014125e+06, -233534.78125}, {1.296011625e+06, -233523.21875}, {1.295901875e+06, -233219.90625}, {1.295877e+06, -233167.9375}, {1.295855e+06, -233159.125}, {1.295757125e+06, -233120.796875}, {1.295696e+06, -233123.078125}, {1.295649875e+06, -233133.609375}, {1.2956195e+06, -233140.28125}, {1.295578e+06, -233150.046875}, {1.295519875e+06, -233141.578125}, {1.295477625e+06, -233117.671875}, {1.295454625e+06, -233085.515625}, {1.295400625e+06, -232909.546875}, {1.29533025e+06, -232838.5}, {1.295182e+06, -232760.03125}, {1.295150875e+06, -232711.234375}, {1.295147125e+06, -232655.375}, {1.295184e+06, -232395.28125}, {1.295172125e+06, -232309.96875}, {1.295139875e+06, -232204.875}, {1.29512275e+06, -232175.171875}, {1.294902375e+06, -231784.28125}, {1.294885e+06, -231660.9375}, {1.294880125e+06, -231551.796875}, {1.29486175e+06, -231439.3125}, {1.29481725e+06, -231338.359375}, {1.29465625e+06, -231105.453125}, {1.294620625e+06, -231041.984375}, {1.2946035e+06, -230983.1875}, {1.294528125e+06, -230831.25}, {1.294489375e+06, -230752.890625}, {1.2944875e+06, -230741.640625}, {1.294456375e+06, -230488.375}, {1.294455375e+06, -230398.703125}, {1.2944545e+06, -230288.5}, {1.294397125e+06, -229953.96875}, {1.2943805e+06, -229931.046875}, {1.2943255e+06, -229857.890625}, {1.29422825e+06, -229748.015625}, {1.29412475e+06, -229662.265625}, {1.29412225e+06, -229647.265625}, {1.29411225e+06, -229602.703125}, {1.29410675e+06, -229552.265625}, {1.29414175e+06, -229515.75}, {1.29415375e+06, -229513.796875}, {1.2942485e+06, -229482.9375}, {1.294307e+06, -229481.09375}, {1.29441225e+06, -229468.609375}, {1.29446525e+06, -229462.53125}, {1.294478e+06, -229460.890625}, {1.29474425e+06, -229450.78125}, {1.294981125e+06, -229412.078125}, {1.29500975e+06, -229415.109375}, {1.2951285e+06, -229393.15625}, {1.29513625e+06, -229390.59375}, {1.295220375e+06, -229357.609375}, {1.295288625e+06, -229323.359375}, {1.295378e+06, -229260}, {1.295406875e+06, -229239.890625}, {1.295440625e+06, -229216.828125}, {1.295483625e+06, -229186.71875}, {1.295502875e+06, -229149.78125}, {1.295637875e+06, -228709.375}, {1.2956695e+06, -228601.5625}, {1.295706625e+06, -228531.765625}, {1.29573625e+06, -228495.703125}, {1.295785625e+06, -228467.109375}, {1.295978875e+06, -228428.671875}, {1.295993375e+06, -228425.859375}, {1.295995625e+06, -228410.109375}, {1.29600525e+06, -228406.390625}, {1.296058125e+06, -228387.046875}, {1.296096875e+06, -228385.84375}, {1.2961605e+06, -228403.25}, {1.296289375e+06, -228439.0625}, {1.296424625e+06, -228422.078125}, {1.296548e+06, -228440.421875}, {1.296647875e+06, -228429.203125}, {1.29671275e+06, -228403.203125}, {1.2967895e+06, -228341.890625}, {1.296912e+06, -228309.4375}, {1.2969125e+06, -228296.515625}, {1.297069e+06, -228158}, {1.2971205e+06, -228080.28125}, {1.297225e+06, -227783.4375}, {1.297258375e+06, -227736.90625}, {1.29740725e+06, -227661.21875}, {1.297470125e+06, -227607.28125}, {1.297598875e+06, -227412.96875}, {1.2976165e+06, -227382.296875}, {1.297619625e+06, -227351.828125}}})

	b := geom.T(geom.Polygon{
		{{1.2677608733770936e+06, -208388.733862126}, {1.2678707522022408e+06, -208781.06448182673}, {1.2680976240444337e+06, -209784.28104683897}, {1.2682762506398628e+06, -210524.2515102632}, {1.2683421264817552e+06, -210798.81206465093}, {1.2686291250587334e+06, -212015.123616104}, {1.268878998579681e+06, -213144.62627540412}, {1.2689662484992282e+06, -213476.03211074858}, {1.268987501819383e+06, -213565.82843846688}, {1.2691325000759806e+06, -214177.36017389176}, {1.2692697488512178e+06, -214679.8898886328}, {1.2692763747627875e+06, -214717.7027373861}, {1.2693305003748117e+06, -215033.49935316062}, {1.2693896242973069e+06, -215274.93560002488}, {1.2694774990056632e+06, -215635.34423688473}, {1.2695415004811287e+06, -215906.7965982065}, {1.269568250892736e+06, -215976.4369239302}, {1.2696089986737934e+06, -216072.93791811028}, {1.269675998085476e+06, -216328.954320624}, {1.2697837505285423e+06, -216775.90408300445}, {1.2697871264882404e+06, -216788.6098722273}, {1.2698548766965591e+06, -216777.32692138432}, {1.2699638734669173e+06, -216759.42330929753}, {1.2699883767389432e+06, -216755.46981372545}, {1.2703876272884766e+06, -217242.45331281004}, {1.270398500713882e+06, -217254.8283314868}, {1.2704178744172836e+06, -217277.79850828438}, {1.2711528728218675e+06, -218131.533038188}, {1.2712276269652369e+06, -218219.13997991197}, {1.271333872564705e+06, -218342.28112885077}, {1.271497498978395e+06, -218532.76821099687}, {1.2717890023351884e+06, -218874.5486907647}, {1.2722090021735686e+06, -219366.688010104}, {1.2723883743153075e+06, -219574.71643183404}, {1.2732197477062442e+06, -220537.68924709712}, {1.273329626531391e+06, -220665.39292943897}, {1.2733675023840577e+06, -220709.74768454395}, {1.2733839989087428e+06, -220728.02932011173}, {1.2734610001916941e+06, -220812.28130344185}, {1.2735332499295021e+06, -220896.8430560131}, {1.2748332516793897e+06, -222408.56420689682}, {1.275078373655194e+06, -222689.76642383286}, {1.2751943743606028e+06, -222821.57586120442}, {1.2751712519243476e+06, -222821.8908807719}, {1.2751279997377289e+06, -222888.26550364587}, {1.2750879975029812e+06, -222974.25009459723}, {1.2750944974067244e+06, -223027.07887606835}, {1.2751423751306594e+06, -223057.8457871615}, {1.2752863758252934e+06, -223044.9194842414}, {1.275330998347031e+06, -223055.68790312414}, {1.2754348760494166e+06, -223141.15796211525}, {1.2755736264179256e+06, -223354.81473345147}, {1.2756267492176597e+06, -223477.09482890577}, {1.2756802500408748e+06, -223694.23256646306}, {1.2756761232845406e+06, -223766.71856894647}, {1.2756286235840865e+06, -223836.35889467038}, {1.2755824994690772e+06, -223931.0170243804}, {1.2756077482874128e+06, -224147.54572410695}, {1.275606498709795e+06, -224219.59594952222}, {1.2756237512814421e+06, -224327.12262856495}, {1.2756624986882457e+06, -224377.31049599522}, {1.2756935018640147e+06, -224459.54635409312}, {1.2757587476667715e+06, -224610.64023932233}, {1.2757776225891914e+06, -224612.75087042456}, {1.275909127507648e+06, -224827.594215465}, {1.2759478749144515e+06, -224877.78208289528}, {1.2759681254223161e+06, -224923.24990713876}, {1.2759852519861362e+06, -224935.90844342648}, {1.2760361223959625e+06, -224950.79836831754}, {1.276122873534528e+06, -224998.37682366348}, {1.276202872753697e+06, -225015.86040966003}, {1.2762842475583102e+06, -225013.0147329003}, {1.2763940003756299e+06, -225028.68695638375}, {1.2764741256026258e+06, -225051.70438611647}, {1.2765243764739693e+06, -225092.341910325}, {1.2765348771262197e+06, -225144.53015200887}, {1.2765576267893198e+06, -225171.64283611905}, {1.2766256237629666e+06, -225199.6113233876}, {1.2766621240301887e+06, -225176.18961854326}, {1.2766826265537073e+06, -225163.4838293204}, {1.2766973747197925e+06, -225179.06154693384}, {1.2769810025873985e+06, -225486.11111938395}, {1.277031127450915e+06, -225538.75088911434}, {1.277113872590647e+06, -225569.45479629422}, {1.2772182490740148e+06, -225611.20538964123}, {1.277320126402147e+06, -225667.89316081442}, {1.2773594985977593e+06, -225700.45568344253}, {1.2773903757657013e+06, -225861.81395624625}, {1.2774202501213532e+06, -225924.954378227}, {1.2774236260810518e+06, -226339.59363363334}, {1.2774196253325446e+06, -226496.72014358034}, {1.2774264980094424e+06, -226539.23203421547}, {1.2774658754553809e+06, -226572.20408228133}, {1.2774960018266868e+06, -226635.7802813307}, {1.2775043760968563e+06, -226722.06414087093}, {1.277463250292318e+06, -226797.10705217766}, {1.2774463757441519e+06, -226815.2206773092}, {1.2774196253325446e+06, -226827.23342348356}, {1.277386627032848e+06, -226834.2636101651}, {1.2774094974534488e+06, -226853.65831487137}, {1.277576872599992e+06, -227002.00102921086}, {1.277630499431034e+06, -226966.40381808253}, {1.2776880010027569e+06, -226950.2958175307}, {1.2778038757003383e+06, -227004.31117270608}, {1.2778523729627565e+06, -227029.8435086524}, {1.2779031226150817e+06, -227018.6550636799}, {1.2779253734972002e+06, -227003.96990150795}, {1.2779640001465026e+06, -226951.54539514845}, {1.2780133742133835e+06, -226935.90467362152}, {1.2780682506220434e+06, -226950.5635841631}, {1.2781123743627989e+06, -226961.40550761134}, {1.2781431255229139e+06, -226969.71677386737}, {1.2781786229778458e+06, -226961.82553370134}, {1.2782675004984923e+06, -226940.6877207216}, {1.2783207493060534e+06, -226945.32900901628}, {1.278382624399438e+06, -226952.45370156807}, {1.2784632484074156e+06, -226918.91986860684}, {1.278509372522425e+06, -226942.28381986357}, {1.2788648773546838e+06, -227118.81028484297}, {1.2791285014797528e+06, -227250.29945232067}, {1.2799934979591952e+06, -227681.06245925743}, {1.2800975016694078e+06, -227732.7046670243}, {1.2802742486480842e+06, -227820.46911853203}, {1.2807798760552392e+06, -228072.2957607978}, {1.2809381261349767e+06, -228151.0769043055}, {1.2812953740755096e+06, -228328.952703099}, {1.281374622498042e+06, -228367.45334457466}, {1.281525375112073e+06, -228442.28099251003}, {1.2816152501946832e+06, -228487.18703185814}, {1.2819673738169177e+06, -228662.46916954592}, {1.2822117502464121e+06, -228784.1559781481}, {1.2834621259137648e+06, -229415.26617969363}, {1.2845918753383928e+06, -229984.5012878545}, {1.2846127506350665e+06, -229994.81292836438}, {1.2846316255574864e+06, -229997.32783457823}, {1.2846722525810427e+06, -229990.74917594343}, {1.284685000372874e+06, -229981.39309478854}, {1.2847297489024387e+06, -229949.76513021067}, {1.2847795009928006e+06, -229919.06122303102}, {1.2848200020085298e+06, -229890.68846065062}, {1.284895874471364e+06, -229945.95339344395}, {1.2849253760538613e+06, -229968.10976969195}, {1.2849323747385861e+06, -229968.6873055657}, {1.285066998350761e+06, -230049.50032528373}, {1.2850836261335989e+06, -230059.2029279631}, {1.2851278758821818e+06, -230079.40618289262}, {1.2852539992163596e+06, -230111.13915399276}, {1.2853272517664577e+06, -230141.606796497}, {1.2853627492213896e+06, -230171.3288926913}, {1.285372625084831e+06, -230211.22087059007}, {1.2853924975692146e+06, -230257.60750190564}, {1.2854273754856638e+06, -230270.76481917524}, {1.285487502220449e+06, -230270.8435740671}, {1.2855533728120145e+06, -230247.34311433113}, {1.2856108743837373e+06, -230218.34556314186}, {1.2856352516479362e+06, -230204.13818064728}, {1.2856661235655518e+06, -230204.70521586877}, {1.2856857492846078e+06, -230220.3459373957}, {1.2856934987659683e+06, -230226.34180983063}, {1.2858220004978813e+06, -230264.9369571763}, {1.285877622452851e+06, -230283.29734763596}, {1.285899873334969e+06, -230302.36128179636}, {1.2859384999842718e+06, -230346.98380353395}, {1.2859643735914165e+06, -230367.17130748508}, {1.2860156272750502e+06, -230384.4973836979}, {1.2860472499893014e+06, -230385.37418816076}, {1.2860602497967873e+06, -230419.1862884066}, {1.2860737483852552e+06, -230434.95301776053}, {1.2861197517427634e+06, -230436.47036201064}, {1.2861346259166761e+06, -230431.4825521917}, {1.2861539996200777e+06, -230424.4996184453}, {1.2861868771622735e+06, -230391.3753109218}, {1.2862173763067345e+06, -230364.18912224588}, {1.2862220018440504e+06, -230351.0318049763}, {1.2862467518814043e+06, -230313.67048426997}, {1.2863841266644686e+06, -230288.3901639774}, {1.28642237529029e+06, -230284.32641155645}, {1.2864491257018978e+06, -230281.24972044723}, {1.2864680006243177e+06, -230283.3446005711}, {1.2865350000360003e+06, -230292.1388968306}, {1.28658600170398e+06, -230286.84131777054}, {1.2866060001961906e+06, -230283.60711687733}, {1.2866252478917656e+06, -230267.23660001927}, {1.286647126000729e+06, -230254.70407155855}, {1.2867316247493867e+06, -230266.21803675103}, {1.286808752040165e+06, -230260.98346160422}, {1.2868701231022417e+06, -230222.78208871768}, {1.2869204999814122e+06, -230187.67315791897}, {1.2869403724657958e+06, -230204.96773217502}, {1.286933751804552e+06, -230269.34198079538}, {1.286927876689618e+06, -230321.60897737113}, {1.2868763762406567e+06, -230366.32600497873}, {1.2868583728723736e+06, -230394.46775300964}, {1.2868530017887475e+06, -230445.7949412088}, {1.2868408735353984e+06, -230480.27908319887}, {1.2868352504361183e+06, -230487.60853846953}, {1.2868268761659488e+06, -230562.11066618515}, {1.286833376069692e+06, -230573.0155935469}, {1.2868471266738134e+06, -230645.18657646305}, {1.2868942483507865e+06, -230758.57786978758}, {1.2868981230914667e+06, -230782.3303451778}, {1.286974998366591e+06, -230805.76780100027}, {1.2869833726367606e+06, -230827.93992822687}, {1.287072376165234e+06, -230837.43776818714}, {1.2871095012212647e+06, -230839.0916209165}, {1.2871478758549136e+06, -230801.23676955444}, {1.2872021274747644e+06, -230799.26789725735}, {1.2872970008678455e+06, -230773.1737764154}, {1.2873391242343476e+06, -230746.25010404573}, {1.2873623726784298e+06, -230708.26399453054}, {1.2873765013060323e+06, -230690.5598948365}, {1.2873994977344605e+06, -230688.96904602065}, {1.287413999135218e+06, -230723.810210187}, {1.287444125506524e+06, -230732.18973068264}, {1.287482752155827e+06, -230713.5143206555}, {1.2875042522413093e+06, -230689.93510602764}, {1.2875148736510603e+06, -230671.5169619806}, {1.2875493735440285e+06, -230610.32966131833}, {1.2876711233565444e+06, -230669.68984848913}, {1.2876631271098559e+06, -230679.95423606364}, {1.2876673746236912e+06, -230689.09505384765}, {1.2877414987279256e+06, -230846.8463526033}, {1.2877596228537094e+06, -230861.85703499522}, {1.2877711263182499e+06, -230865.12273784494}, {1.2879054979147702e+06, -230897.18647949118}, {1.2880421271515246e+06, -230998.1555012036}, {1.2880506274295212e+06, -231050.66926310724}, {1.2880616268627536e+06, -231101.06189325615}, {1.2880810005661552e+06, -231132.12282261252}, {1.2881159992401055e+06, -231137.1421343882}, {1.2881562482401808e+06, -231137.0161265612}, {1.2882198769424912e+06, -231150.18919480918}, {1.2882957494053254e+06, -231221.28386086947}, {1.2883195018807156e+06, -231300.37477361853}, {1.2882969989829431e+06, -231363.48369364277}, {1.2882878739161375e+06, -231387.624693166}, {1.2882953766321703e+06, -231417.20503055514}, {1.2883196226382162e+06, -231461.1555105485}, {1.2883757486244938e+06, -231562.8123249833}, {1.2883890004476337e+06, -231606.42153377878}, {1.2884038746215464e+06, -231634.79429615894}, {1.2884276270969366e+06, -231658.73578328965}, {1.2884678760970118e+06, -231671.43632218638}, {1.288477625952626e+06, -231676.2823731997}, {1.2885242488486175e+06, -231698.6225108623}, {1.2885294991747425e+06, -231714.0322180395}, {1.2885108762679766e+06, -231738.4357338692}, {1.2884817474586344e+06, -231752.5801124503}, {1.2884551230548536e+06, -231747.9388241556}, {1.2884309978063088e+06, -231750.99976428668}, {1.2884205024043848e+06, -231783.48353202268}, {1.2884143752737967e+06, -231838.35994068277}, {1.2884383745145146e+06, -231952.50203064317}, {1.2884281258779182e+06, -232002.9209124227}, {1.2884224975283123e+06, -232010.25036769337}, {1.2884530019230992e+06, -232025.8280853068}, {1.2885122518534213e+06, -232053.42379942047}, {1.2885601243270305e+06, -232087.5456689077}, {1.2885700001904718e+06, -232123.14288003603}, {1.288624125802496e+06, -232161.40725683607}, {1.2886606260697176e+06, -232179.85690283985}, {1.288662999217126e+06, -232194.8570845793}, {1.2886473742465777e+06, -232208.09315674077}, {1.2886357500245366e+06, -232242.047015792}, {1.288618250687562e+06, -232243.1863365611}, {1.2885967506020796e+06, -232233.00070387847}, {1.2886235010136869e+06, -232258.59604373854}, {1.288726123888129e+06, -232339.41956410883}, {1.2887401265079044e+06, -232362.79926634394}, {1.2887751251818547e+06, -232413.58042062633}, {1.2887692500669206e+06, -232445.31339172646}, {1.2887666249038582e+06, -232474.8307252021}, {1.2887632489441596e+06, -232496.32556035835}, {1.2887521235031006e+06, -232507.97078370396}, {1.2887503751445008e+06, -232539.04746403848}, {1.2887497503556916e+06, -232569.07932947436}, {1.288742872428468e+06, -232594.15488704806}, {1.2887306234176182e+06, -232606.84492529253}, {1.288724249521702e+06, -232609.596096182}, {1.288730124636636e+06, -232628.73353490815}, {1.2887653753262404e+06, -232656.37650195695}, {1.2888139985964852e+06, -232674.12260426}, {1.2888643754756558e+06, -232668.49950497993}, {1.2889607504620086e+06, -232601.51584427548}, {1.2890200003923308e+06, -232591.89199648798}, {1.2890857502263961e+06, -232583.7802426247}, {1.289120622892519e+06, -232562.72118453681}, {1.2891364998787213e+06, -232543.01671058917}, {1.2891429997824645e+06, -232544.96983190766}, {1.2891544979966786e+06, -232536.24904021388}, {1.2891608771429206e+06, -232508.26480196696}, {1.2891668730153553e+06, -232444.00081019523}, {1.2891746224967162e+06, -232407.67380373552}, {1.2892218754318422e+06, -232399.98207596224}, {1.2892626232128995e+06, -232414.7512433522}, {1.289282500947609e+06, -232444.8776146581}, {1.2893083745547538e+06, -232486.42344528646}, {1.2893648733141865e+06, -232531.1247219157}, {1.2893866254153228e+06, -232509.20461034332}, {1.2894108766716947e+06, -232477.46638891683}, {1.289456622763223e+06, -232468.75084754918}, {1.2894992501610331e+06, -232449.42439708253}, {1.289512748749501e+06, -232423.2672723271}, {1.2895101235864381e+06, -232415.56504390156}, {1.2895820005510915e+06, -232382.07846387546}, {1.2895934987653056e+06, -232368.674381278}, {1.2895801261846647e+06, -232328.9241621846}, {1.2895966227093497e+06, -232316.40738470224}, {1.289625373495211e+06, -232317.27893883898}, {1.2896541242810725e+06, -232346.82777427137}, {1.2896896269863304e+06, -232363.2980473258}, {1.2897336247192593e+06, -232356.56187890726}, {1.2897563743823594e+06, -232340.88965542382}, {1.289769998978654e+06, -232306.61027615285}, {1.2897784992566505e+06, -232279.5448449778}, {1.289792622633927e+06, -232257.15745438007}, {1.2898446271141968e+06, -232249.12445540866}, {1.2899267474651197e+06, -232240.90769502288}, {1.289963000967014e+06, -232224.73669055733}, {1.2899973748521553e+06, -232196.06465958804}, {1.2900471269425168e+06, -232161.8745358612}, {1.29007637650936e+06, -232122.9066153604}, {1.2901021241086777e+06, -232075.10764631722}, {1.2901081252314388e+06, -232032.2177322011}, {1.2905335014037709e+06, -231588.78043799824}, {1.2907152519432446e+06, -231399.2489152071}, {1.2909143758118665e+06, -231191.04723271495}, {1.2911925013376935e+06, -230900.71994897327}, {1.2915341243076776e+06, -230543.561263985}, {1.2916204974227622e+06, -230452.93538473896}, {1.292216251928181e+06, -229822.9540033103}, {1.292466750237937e+06, -229561.41950803902}, {1.2925373776249727e+06, -229487.46866456652}, {1.2926343774001342e+06, -229386.54689578922}, {1.2929614989693607e+06, -229045.37545385188}, {1.293176247808531e+06, -228820.8610080888}, {1.2931838765323912e+06, -228812.78075618227}, {1.2932007510805572e+06, -228795.0451545315}, {1.293440748738063e+06, -228544.2055735772}, {1.2935101265474805e+06, -228471.2837940252}, {1.293710373985893e+06, -228258.11005269247}, {1.293951873236671e+06, -228000.14052886027}, {1.293959874733686e+06, -227991.12571890326}, {1.2940027488968237e+06, -227939.64102092036}, {1.2940418743271083e+06, -227911.03199386434}, {1.29406612558348e+06, -227883.96656268928}, {1.2941130004951255e+06, -227832.26660133502}, {1.2941260003026114e+06, -227819.8758316799}, {1.294176125166128e+06, -227767.20455999253}, {1.294192873706467e+06, -227756.76691165566}, {1.294242499789002e+06, -227721.72098477045}, {1.2942477501151268e+06, -227699.06057721446}, {1.2942411242035571e+06, -227671.06058798893}, {1.2942578727438962e+06, -227648.21641901857}, {1.2942742485110806e+06, -227639.96815667604}, {1.2942828747969042e+06, -227630.01353834267}, {1.2943041228667325e+06, -227609.0174841683}, {1.294307876849912e+06, -227527.563924663}, {1.2943263737488505e+06, -227498.87614271534}, {1.2943646276249983e+06, -227473.7953348155}, {1.2943772494090032e+06, -227446.09461417934}, {1.2943967491202322e+06, -227402.6849177766}, {1.2944196247911593e+06, -227362.60917846346}, {1.2944307502322183e+06, -227347.09446476377}, {1.2944452516329759e+06, -227340.0170251471}, {1.2944544974572826e+06, -227341.93864450883}, {1.294482124673353e+06, -227327.1537261405}, {1.2945020024080626e+06, -227323.48374817893}, {1.294509872646924e+06, -227300.3928138807}, {1.2945056251330888e+06, -227266.01367841335}, {1.2945151229730495e+06, -227249.0446243768}, {1.2945522480290802e+06, -227228.88862238242}, {1.294571500974981e+06, -227209.0633909339}, {1.2945910006862096e+06, -227194.3257255007}, {1.2946270021724496e+06, -227146.96778385201}, {1.2946557477079849e+06, -227060.1273897423}, {1.2946722494829963e+06, -227047.61061225994}, {1.2947310006323364e+06, -227001.65450768662}, {1.2947406244801236e+06, -226997.95302776853}, {1.2947462475794037e+06, -226978.20130088576}, {1.2947613737689704e+06, -226966.3145625384}, {1.2947773767629997e+06, -226959.8619117306}, {1.29478787741525e+06, -226944.4522045534}, {1.2948056235175529e+06, -226931.72016369994}, {1.2948253752444359e+06, -226927.20488323225}, {1.2948604999262127e+06, -226941.1549997467}, {1.2948911250785007e+06, -226940.84523050534}, {1.294954249749503e+06, -226938.23581842124}, {1.2950102497279542e+06, -226938.0625576591}, {1.2950470020108297e+06, -226920.09594165883}, {1.2950616241690884e+06, -226905.72054872825}, {1.2950883745806958e+06, -226872.6854967489}, {1.2950982504441375e+06, -226849.26379190455}, {1.295112373821414e+06, -226839.6871970524}, {1.2951807488185414e+06, -226814.82690284983}, {1.2952048740670867e+06, -226828.43574816617}, {1.295273123056387e+06, -226815.56194850733}, {1.2953567502509085e+06, -226717.20233887923}, {1.2953916229170314e+06, -226696.5318049246}, {1.2954347490958232e+06, -226663.81177251274}, {1.2954466253335183e+06, -226631.937042607}, {1.295467500630192e+06, -226616.98411380267}, {1.2955097500045206e+06, -226603.66928674933}, {1.2955497522392683e+06, -226594.1241938537}, {1.2955837481009285e+06, -226567.61004692176}, {1.2956008746647486e+06, -226534.85851255315}, {1.295617502447587e+06, -226494.09498051764}, {1.2956319985980187e+06, -226478.02898257482}, {1.2956618729536706e+06, -226452.18687738688}, {1.2956933749104212e+06, -226448.73216279666}, {1.2957445025862278e+06, -226493.43868975202}, {1.295780498822142e+06, -226504.6586366815}, {1.2958151247229371e+06, -226512.25060825842}, {1.2958858728674734e+06, -226560.13883284573}, {1.2959092525697085e+06, -226598.67097627814}, {1.2959498743429384e+06, -226659.59576063417}, {1.295953749083619e+06, -226666.23217285634}, {1.2959800007142448e+06, -226717.98463747185}, {1.2960075019224882e+06, -226781.9231090236}, {1.2960437501740558e+06, -226836.7207627918}, {1.2960772525050603e+06, -226874.454856653}, {1.2961200006603715e+06, -226893.54504244402}, {1.2961523741712589e+06, -226898.95287835295}, {1.2961762474041497e+06, -226923.71866668528}, {1.2962147480456256e+06, -226937.9365498321}, {1.2962347517881622e+06, -226959.9039143396}, {1.2962397500986336e+06, -226981.7662723246}, {1.296235623342299e+06, -227019.6421249914}, {1.296247751595648e+06, -227076.70266931923}, {1.2962710000397302e+06, -227118.67377636372}, {1.2963124986174232e+06, -227138.81402737973}, {1.296387000745139e+06, -227159.98334231623}, {1.296433875656784e+06, -227166.4517441024}, {1.2964934983602613e+06, -227188.76563013415}, {1.2965341253838176e+06, -227215.48453978496}, {1.2965655013327412e+06, -227214.6549882572}, {1.2966072519260882e+06, -227215.0960156517}, {1.2966365014929315e+06, -227231.67129522888}, {1.2966956254154267e+06, -227300.70258312207}, {1.2967316269016666e+06, -227353.42110774457}, {1.2967924991827612e+06, -227411.92024143087}, {1.2968318766286997e+06, -227439.68921630667}, {1.296883749850816e+06, -227451.73346443777}, {1.2969038743508537e+06, -227479.2346726812}, {1.2969203761258652e+06, -227513.31453955942}, {1.2969191265482474e+06, -227547.31040121964}, {1.2969311235434432e+06, -227578.71785210026}, {1.2969575011818958e+06, -227598.34357115603}, {1.2970036252969052e+06, -227604.48645272222}, {1.2970287481074142e+06, -227573.87705141283}, {1.2970563753234847e+06, -227554.81311725243}, {1.2970783741899487e+06, -227513.9865813034}, {1.297094497941479e+06, -227470.29861761606}, {1.2971094981232188e+06, -227457.98660285282}, {1.2971541258952823e+06, -227467.7994623806}, {1.2972072486950164e+06, -227478.79889561282}, {1.2972433761890833e+06, -227495.1116588835}, {1.2972618730880222e+06, -227503.63818851067}, {1.2972810000260961e+06, -227520.6072425472}, {1.2973085012343396e+06, -227563.17163644359}, {1.2973241262048879e+06, -227566.5948490773}, {1.297346749860161e+06, -227562.88811883284}, {1.2973705023355512e+06, -227545.31002696604}, {1.2973988750979314e+06, -227514.1545917394}, {1.2974456240017498e+06, -227495.37417518976}, {1.297499376840619e+06, -227464.34474779014}, {1.2975128754290864e+06, -227446.73515396658}, {1.297546624525419e+06, -227402.700668755}, {1.2975868735254942e+06, -227385.4218454773}, {1.2975983769900342e+06, -227384.4085325352}, {1.2976196250598626e+06, -227351.8302589287}, {1.2976290021423222e+06, -227350.2971637}, {1.2976327508751755e+06, -227331.71625954332}, {1.2976329976405036e+06, -227266.2341921106}, {1.2976380012013009e+06, -227259.01499368856}, {1.2976407523721904e+06, -227251.2655123279}, {1.2976513737819414e+06, -227215.75230641733}, {1.2978304991583526e+06, -227095.31507543288}, {1.29788837350323e+06, -227056.3261536276}, {1.2979508733854238e+06, -226983.62488777307}, {1.2979785006014942e+06, -226959.87241238286}, {1.2979986251015319e+06, -226949.29825556674}, {1.2980085009649731e+06, -226922.43758711056}, {1.2980258742941213e+06, -226915.73292064876}, {1.298054997853137e+06, -226922.1068165647}, {1.2980835018736706e+06, -226942.23656692845}, {1.2981147518147673e+06, -226970.48332148185}, {1.298127625614426e+06, -226961.11148934835}, {1.2981618734917403e+06, -226949.0777418695}, {1.298187999114539e+06, -226933.2480086023}, {1.2981963733847085e+06, -226905.35827622563}, {1.2981943730104552e+06, -226893.28252613777}, {1.298187873106712e+06, -226857.98458359856}, {1.2981745005260715e+06, -226825.95234390907}, {1.2981677486066744e+06, -226784.7162825223}, {1.2981617474839133e+06, -226752.32702065632}, {1.2981607499219496e+06, -226712.7185603683}, {1.2981757501036893e+06, -226688.0000249711}, {1.2982168759082272e+06, -226680.42380437255}, {1.2982453746784348e+06, -226686.89220615872}, {1.298291000012462e+06, -226690.11065607355}, {1.2984056251324262e+06, -226702.1076512693}, {1.2984581231433512e+06, -226680.6863206788}, {1.2984931270676274e+06, -226644.13880052185}, {1.2985083740146947e+06, -226595.45252636354}, {1.2985033757042238e+06, -226506.43849723786}, {1.2984988761747344e+06, -226495.62282542023}, {1.2984836239773408e+06, -226460.92342005903}, {1.2984695006000642e+06, -226378.54580315575}, {1.2984986241590804e+06, -226231.326658607}, {1.2985004985255073e+06, -226222.0335813656}, {1.2984894990922748e+06, -226134.00136322528}, {1.2985049980549961e+06, -226061.7516254175}, {1.2985660015942445e+06, -226000.42256594985}, {1.2985723754901602e+06, -225997.25136897014}, {1.298604250220066e+06, -225979.6102731896}, {1.2986132492790446e+06, -225858.79501872417}, {1.2986201272062683e+06, -225851.25030008238}, {1.298670498835113e+06, -225837.01666595717}, {1.298700997979574e+06, -225815.31181775592}, {1.2987118766553048e+06, -225810.54452163423}, {1.2987263728057365e+06, -225815.4535765613}, {1.2987893767192382e+06, -225879.12428148068}, {1.2988421267458173e+06, -225888.4383600268}, {1.2988724998824513e+06, -225873.2019136115}, {1.2989049994011656e+06, -225821.66996269347}, {1.2989074985564016e+06, -225803.31482255994}, {1.2989507507430203e+06, -225742.31128331204}, {1.2989947484759488e+06, -225698.31355038332}, {1.2990141274296767e+06, -225678.87684306805}, {1.299029374376744e+06, -225663.54589078273}, {1.299095748999618e+06, -225664.21793252672}, {1.299112623547784e+06, -225662.73209023336}, {1.2991105024160296e+06, -225645.96779891592}, {1.2990873747294485e+06, -225600.1587034741}, {1.2990782496626428e+06, -225581.96632345044}, {1.2990796252480876e+06, -225549.22003940796}, {1.2991023749111881e+06, -225504.44000788662}, {1.2991356252265386e+06, -225486.15837231907}, {1.2992557474379553e+06, -225481.4383291325}, {1.2992797519289996e+06, -225456.96655906318}, {1.2997851273205006e+06, -224822.70091151632}, {1.3011324975126889e+06, -223130.0482720344}, {1.3011557512070974e+06, -223100.98246660572}, {1.3012824993300843e+06, -222941.14153805212}, {1.301733749109561e+06, -222370.76710912213}, {1.3019001266941405e+06, -222160.78031574725}, {1.3019527507128925e+06, -222099.07848312473}, {1.301963498130471e+06, -222122.5474409042}, {1.3019652517393967e+06, -222149.65487468825}, {1.3019629993494889e+06, -222177.8123736973}, {1.3019471276136125e+06, -222222.76566598075}, {1.3019812494830997e+06, -222268.07598044048}, {1.3019838746461626e+06, -222283.9057137079}, {1.3020296259880168e+06, -222292.20122898556}, {1.3020498764958815e+06, -222315.40767045855}, {1.3020550008141794e+06, -222359.06413218915}, {1.302058749547033e+06, -222399.06111661042}, {1.302083877607868e+06, -222430.87284260266}, {1.3021203726247638e+06, -222428.73595986958}, {1.302148997402798e+06, -222415.88841184136}, {1.3022201235708152e+06, -222437.56175808609}, {1.3022711252387948e+06, -222448.0151574011}, {1.3022927513321042e+06, -222442.74908029754}, {1.3023282487870362e+06, -222434.34330817126}, {1.302383125195696e+06, -222415.04835966136}, {1.3024516262006508e+06, -222390.97036405164}, {1.3025256242970582e+06, -222376.21694763983}, {1.3025837506575896e+06, -222384.6384707447}, {1.3026085006949436e+06, -222398.51508269343}, {1.3027317521007312e+06, -222424.8927211461}, {1.3028264994859854e+06, -222448.67144816671}, {1.3028481255792947e+06, -222438.7010788552}, {1.3030119987583123e+06, -222409.18899570568}, {1.3030623756374829e+06, -222388.0459323998}, {1.3030861228625472e+06, -222345.63904828718}, {1.303104751019639e+06, -222242.48589090654}, {1.303104877027466e+06, -222159.9087616105}, {1.3031242507308675e+06, -222128.88983486313}, {1.303115876460698e+06, -222081.51614223607}, {1.303074876663987e+06, -222060.8771102382}, {1.3030708759154794e+06, -222052.98587007215}, {1.303068376760244e+06, -222004.6251161336}, {1.3030757482181238e+06, -221970.89177077962}, {1.3030695003300346e+06, -221949.24992649187}, {1.3030698731031897e+06, -221918.38850952825}, {1.3030903756267084e+06, -221906.02924182964}, {1.3030958727181614e+06, -221898.2640094906}, {1.3031131252898085e+06, -221874.06000605365}, {1.3031211267868234e+06, -221868.46840873058}, {1.3031333757976731e+06, -221860.03113464732}, {1.3031501243380122e+06, -221824.76469406486}, {1.3031948728675768e+06, -221764.7797180852}, {1.3032121254392238e+06, -221741.38951519784}, {1.3032451237389203e+06, -221688.48197883484}, {1.3032592523665233e+06, -221636.98678019946}, {1.3032596251396784e+06, -221539.81374427537}, {1.30326012392066e+06, -221476.82558175223}, {1.303274000532609e+06, -221440.75059094653}, {1.3033711263155974e+06, -221325.09115673578}, {1.303409747714574e+06, -221298.62426273897}, {1.3034536246900018e+06, -221291.40506431693}, {1.3035006256094743e+06, -221277.70171313034}, {1.3035423762028213e+06, -221241.29595177877}, {1.3035643750692853e+06, -221209.0169467614}, {1.303643623491818e+06, -221092.45445645717}, {1.3036811265713302e+06, -221030.23284154828}, {1.3037212495635785e+06, -220999.68644415238}, {1.303748498756168e+06, -220957.9673527619}, {1.3037666228819517e+06, -220910.49915426457}, {1.3037975000498937e+06, -220890.4534091188}, {1.3038352498947335e+06, -220904.33002106752}, {1.3038617482906869e+06, -220923.9399891449}, {1.3039116263888758e+06, -220965.35981194605}, {1.3039300025303136e+06, -220956.76502807927}, {1.3039366231915574e+06, -220914.59440864227}, {1.3039471238438077e+06, -220853.82713407}, {1.3039775022307676e+06, -220809.90815603314}, {1.3040511275540204e+06, -220772.11105825845}, {1.3040974984343578e+06, -220750.77898321184}, {1.3041140002093688e+06, -220742.93499598093}, {1.3041299979530722e+06, -220724.04432258266}, {1.3041370018881233e+06, -220674.9852752695}, {1.3041387502467227e+06, -220660.99840647215}, {1.3041446253616568e+06, -220609.9704868619}, {1.3041787524814704e+06, -220584.2648901532}, {1.3042217474021087e+06, -220575.90637096204}, {1.3042329988509952e+06, -220582.17001002934}, {1.3044047475192007e+06, -220675.3895503811}, {1.3044228768953108e+06, -220669.40417859843}, {1.3044613775367863e+06, -220642.0919820955}, {1.3045036269111154e+06, -220645.40493788058}, {1.3045486274563335e+06, -220698.74825131195}, {1.3045579992884672e+06, -220710.04695313307}, {1.304589874018373e+06, -220700.92188632768}, {1.3046303750341022e+06, -220681.0021490089}, {1.3046383765311167e+06, -220655.29655230022}, {1.3046417524908152e+06, -220613.65621580184}, {1.3046667492934968e+06, -220612.10736959497}, {1.3046939984860863e+06, -220636.29562205332}, {1.304734126728661e+06, -220693.424420621}, {1.3047411254133857e+06, -220698.68524739845}, {1.304757375172743e+06, -220710.12570802495}, {1.30481524951762e+06, -220828.93533791066}, {1.3048277505441243e+06, -220888.48453682195}, {1.3048487518486246e+06, -220908.1260068561}, {1.3048696271452983e+06, -220898.26589439297}, {1.304907376990138e+06, -220924.1237505593}, {1.3049575018536546e+06, -220917.17231876962}, {1.305014751409723e+06, -220879.0759524058}, {1.305151123380497e+06, -220683.32804348227}, {1.3051920024197078e+06, -220624.40888370597}, {1.3052553738560379e+06, -220566.03050752077}, {1.3052749995750939e+06, -220543.56436203117}, {1.3052851274541891e+06, -220518.35754630459}, {1.3053061235083635e+06, -220512.76594898128}, {1.3054028765181974e+06, -220519.92214348982}, {1.3054326248660227e+06, -220506.01402958436}, {1.3054371243955116e+06, -220495.8756498366}, {1.305447877063416e+06, -220473.98178989487}, {1.305470500718689e+06, -220466.40556929633}, {1.3054932503817896e+06, -220475.9244105611}, {1.3055890005793334e+06, -220406.2368319023}, {1.3056445017768024e+06, -220340.62350631645}, {1.305656624779825e+06, -220336.04522193526}, {1.3056978765921905e+06, -220308.29724836396}, {1.3057986251002057e+06, -220268.9985573173}, {1.3058623745600171e+06, -220262.34114379063}, {1.3058903745492422e+06, -220253.87761807698}, {1.3059011272171466e+06, -220252.953560679}, {1.3062706241685292e+06, -219785.15475325566}, {1.3063773737993054e+06, -219649.48632618226}, {1.306782998244755e+06, -219136.34570234222}, {1.306775626786875e+06, -219104.18745482573}, {1.3065960026294822e+06, -218830.49845457473}, {1.30649412530135e+06, -218730.9365202638}, {1.3064767519722017e+06, -218683.3265629611}, {1.3064821230558278e+06, -218641.37645722134}, {1.3064281234516306e+06, -218467.1706363894}, {1.306416625237417e+06, -218426.70112261688}, {1.306421497540061e+06, -218394.2488568374}, {1.3064850002345443e+06, -218261.84613261372}, {1.3065326259428253e+06, -218223.6080074443}, {1.3065796268622978e+06, -218222.2796749347}, {1.3066523753810874e+06, -218212.40381149342}, {1.3066748730285335e+06, -218187.31250294135}, {1.3066680003516357e+06, -218154.20394639624}, {1.3066124991541672e+06, -218070.10947284987}, {1.3066135019664569e+06, -218051.54431967158}, {1.306625252196325e+06, -218023.50232783705}, {1.3066644983841106e+06, -217942.16952583264}, {1.3066619992288747e+06, -217922.9060792795}, {1.3066461274929987e+06, -217922.51755514625}, {1.306613748731785e+06, -217920.1706593684}, {1.3065903742798758e+06, -217878.236304607}, {1.3065153733711783e+06, -217730.17185755214}, {1.3064724992080405e+06, -217693.62433739495}, {1.3064363769642995e+06, -217677.34307608102}, {1.3062851255692868e+06, -217621.43760350044}, {1.3062462521546562e+06, -217625.7166192925}, {1.3061738764090212e+06, -217646.63916890114}, {1.3060128751583938e+06, -217692.8735407591}, {1.3059081259018714e+06, -217682.35713753034}, {1.3058401236778987e+06, -217642.66992235067}, {1.3058096245334377e+06, -217590.36092316592}, {1.3057683727210728e+06, -217423.46880662628}, {1.3057911276344988e+06, -217358.1232476728}, {1.3058382493114718e+06, -217312.70267636422}, {1.3058836226298455e+06, -217298.3587853904}, {1.3059198761317395e+06, -217286.38804182503}, {1.3059846231535147e+06, -217265.01396416966}, {1.306025502192725e+06, -217227.04885595874}, {1.3060792497812677e+06, -217106.09184268792}, {1.3060849988883748e+06, -217074.3431206094}, {1.3060737474394888e+06, -217064.64051793003}, {1.306047123035708e+06, -217068.60976448073}, {1.305976002118017e+06, -217067.5176966465}, {1.3059328759392253e+06, -217042.53139461717}, {1.3059078738862174e+06, -216985.50235224585}, {1.3058842474186542e+06, -216979.53273144155}, {1.3058184975845893e+06, -216973.70486944262}, {1.3057390023967284e+06, -216930.76770239137}, {1.3056796264585797e+06, -216876.82585178176}, {1.3056661226197854e+06, -216832.40809276304}, {1.3056745021402813e+06, -216796.37510456634}, {1.3056901271108296e+06, -216729.21818309976}, {1.3056909986649663e+06, -216701.2654468096}, {1.30567024937612e+06, -216671.2965852872}, {1.3056362482641335e+06, -216630.28103759768}, {1.305628498782773e+06, -216591.78039612202}, {1.305634373897707e+06, -216499.24864849262}, {1.3056153729674602e+06, -216442.0620963378}, {1.3055343761863275e+06, -216343.76549062296}, {1.305470374710862e+06, -216303.42198467744}, {1.3053196273471573e+06, -216250.40419146582}, {1.3052742487784578e+06, -216206.98399441107}, {1.3050579983460158e+06, -215980.3904195025}, {1.3050332483086619e+06, -215962.2505427401}, {1.304992626535432e+06, -215931.29461990646}, {1.3049768755570562e+06, -215927.03135509277}, {1.304900997843896e+06, -215905.75178330764}, {1.3048752502445783e+06, -215894.59484029165}, {1.3048256241620434e+06, -215887.3756418696}, {1.3048256241620434e+06, -215874.5490951459}, {1.3048067492396235e+06, -215772.41975135985}, {1.3048503741993974e+06, -215652.28178896452}, {1.3048529993624599e+06, -215618.48543969705}, {1.3048382511963747e+06, -215561.8921743941}, {1.3048222482023449e+06, -215548.251827121}, {1.3048086236060504e+06, -215535.9555633359}, {1.3047478773327824e+06, -215522.8770009582}, {1.3046578762423457e+06, -215519.73205560935}, {1.3046027478180313e+06, -215495.47029858502}, {1.3045601256705476e+06, -215456.2976153656}, {1.3045469998552348e+06, -215422.51701707626}, {1.3044593771625324e+06, -215354.81406169268}, {1.3044286260024174e+06, -215341.91926072934}, {1.3044145026251408e+06, -215318.5763107771}, {1.304312625297009e+06, -215255.35713390424}, {1.3043077477440387e+06, -215212.9712510961}, {1.30437912592771e+06, -215054.453404726}, {1.3043814990751185e+06, -215023.26646754285}, {1.3043718752273312e+06, -214981.2166056065}, {1.3043308754306198e+06, -214931.5012675277}, {1.3043147516790894e+06, -214895.6572910715}, {1.3043023766604126e+06, -214815.99934310094}, {1.3042857488775742e+06, -214702.81281249528}, {1.3042668739551543e+06, -214667.40461310744}, {1.3042416251368187e+06, -214638.2022991993}, {1.3041282495944723e+06, -214525.98182860063}, {1.3041061247201813e+06, -214498.84289285983}, {1.304053747466757e+06, -214384.2492748527}, {1.304034625779009e+06, -214359.173717279}, {1.303970624303544e+06, -214310.67120453506}, {1.303729623833748e+06, -214214.3592220957}, {1.3037088745449013e+06, -214196.37685511704}, {1.3036306236843322e+06, -214127.56083059497}, {1.3036308756999862e+06, -214078.7642995878}, {1.303651498981006e+06, -214034.2992876342}, {1.3036720015045246e+06, -214005.24923318368}, {1.3037198739781333e+06, -213969.12698944286}, {1.3037795019319365e+06, -213941.34226358868}, {1.3037878762021065e+06, -213930.12756698532}, {1.3037688752718596e+06, -213848.10697225854}, {1.303757497815146e+06, -213824.3282452377}, {1.3036008753365073e+06, -213726.92419496435}, {1.3035815016331058e+06, -213704.45279914862}, {1.3035698774110647e+06, -213634.4869532052}, {1.3036056268816506e+06, -213569.56142034172}, {1.303632624058586e+06, -213547.15827876586}, {1.3036188734544641e+06, -213446.7510419488}, {1.3036301249033506e+06, -213424.35840102518}, {1.3036768738071686e+06, -213396.98320060875}, {1.3036911231922721e+06, -213388.64043239574}, {1.303790249349515e+06, -213356.9074612956}, {1.3038106258652066e+06, -213335.58063657512}, {1.3038187481197221e+06, -213326.54482531385}, {1.3038118754428243e+06, -213268.63897847966}, {1.3037912521618046e+06, -213238.6701169575}, {1.3037783731118198e+06, -213176.64276411524}, {1.303784752258062e+06, -213137.0763064362}, {1.3038316271697069e+06, -213031.8282689317}, {1.3038648774850573e+06, -212923.65579977562}, {1.3038774992690622e+06, -212921.5766706299}, {1.3038646254694033e+06, -212892.9046396606}, {1.3038394974085684e+06, -212860.68863855675}, {1.3038266236089095e+06, -212844.42312822118}, {1.3038197509320118e+06, -212836.12761294353}, {1.3037419988524248e+06, -212782.21726429067}, {1.303513373401306e+06, -212699.23585988279}, {1.3034440008422146e+06, -212679.8569061549}, {1.3033884996447456e+06, -212653.09599389508}, {1.303346502286071e+06, -212647.15787504753}, {1.303201876802628e+06, -212655.57939815242}, {1.3030845005117743e+06, -212671.92366337986}, {1.3029323775626249e+06, -212663.6071467977}, {1.3027576257078755e+06, -212625.65778956516}, {1.302582627087799e+06, -212556.93627091334}, {1.3025666240937696e+06, -212539.03265882656}, {1.3025596254090448e+06, -212496.54701982206}, {1.302622377306892e+06, -212409.21834538272}, {1.3026227500800472e+06, -212365.53038169537}, {1.3025973752538846e+06, -212302.96749558835}, {1.3025761271840557e+06, -212285.9354376383}, {1.3024543773715403e+06, -212275.1880200603}, {1.30238337721135e+06, -212245.81244539004}, {1.302382626414714e+06, -212225.38867676328}, {1.3024466226398535e+06, -212132.736171633}, {1.3024429999148268e+06, -212094.81306603132}, {1.3023957522300268e+06, -212056.39117944753}, {1.3023339978941432e+06, -212020.79921864532}, {1.3022428732339153e+06, -211968.6424789182}, {1.3021997523054495e+06, -211921.84632216487}, {1.3021945019793245e+06, -211861.09479857096}, {1.3022072497711563e+06, -211814.4981542104}, {1.3022283770834836e+06, -211740.01702779927}, {1.3022066249823472e+06, -211561.79470748152}, {1.3022183752122154e+06, -211504.68691021833}, {1.3021813761640117e+06, -211421.35898428643}, {1.3021343752445392e+06, -211379.90765952854}, {1.3021041228654063e+06, -211353.65602890286}, {1.3020977489694906e+06, -211347.87541983905}, {1.3020956225874098e+06, -211335.37439333508}, {1.302087873106049e+06, -211287.8904438594}, {1.3021121243624212e+06, -211232.5625071528}, {1.3021327476434405e+06, -211212.48526005028}, {1.3022246231003045e+06, -211124.21677723457}, {1.3022433772652233e+06, -211085.1858528203}, {1.3022407521021608e+06, -211052.26630801568}, {1.3022250011237855e+06, -211018.92148679495}, {1.3021835025460925e+06, -210982.1272013099}, {1.3021063752553142e+06, -210981.98544250452}, {1.3020814992101332e+06, -210955.2665328537}, {1.3020307495578076e+06, -210878.9372916466}, {1.3020211257100203e+06, -210853.5624654838}, {1.3020126254320238e+06, -210830.59228868643}, {1.3020066243092627e+06, -210823.4360941779}, {1.3019942492905855e+06, -210810.49929060554}, {1.3019632513651429e+06, -210638.51435772446}, {1.3019488759722123e+06, -210630.18734049005}, {1.3019020010605673e+06, -210651.59292010218}, {1.301830124095914e+06, -210683.51490294305}, {1.3017948734063096e+06, -210689.31126298523}, {1.3017847507775407e+06, -210685.43652230478}, {1.301674997960221e+06, -210644.452476572}, {1.3016371273578801e+06, -210630.14008755493}, {1.3015548757488038e+06, -210582.0786022055}, {1.3015405003558733e+06, -210494.62391993892}, {1.301549499414852e+06, -210470.04714334733}, {1.3015790009973487e+06, -210434.3921786314}, {1.3016817498796177e+06, -210386.68771545845}, {1.3016956264915667e+06, -210363.85929746646}, {1.3016953744759127e+06, -210333.10813735146}, {1.3016847478158353e+06, -210314.31196982344}, {1.3016416268873694e+06, -210300.8921362476}, {1.301492249858783e+06, -210325.46891283942}, {1.3014418729796126e+06, -210359.42277189065}, {1.301420000120975e+06, -210363.43927137647}, {1.3013400009018066e+06, -210378.7492223573}, {1.3013129984745448e+06, -210367.79704206018}, {1.3012732482554517e+06, -210382.8917296701}, {1.3012071256482317e+06, -210408.31380876806}, {1.3011591271667955e+06, -210411.06497965753}, {1.301122122868266e+06, -210388.9401053663}, {1.301108498271971e+06, -210368.08055967093}, {1.3011041247503087e+06, -210325.15389327193}, {1.301125372820137e+06, -210267.7678287241}, {1.301200625744489e+06, -210152.73318332247}, {1.3012677511639986e+06, -210080.0949213812}, {1.3012707491002162e+06, -210035.97118062573}, {1.301258374081539e+06, -209973.81256963033}, {1.3012353724027849e+06, -209928.85927734687}, {1.3012178730658097e+06, -209913.76458973717}, {1.301189127530275e+06, -209879.9997424262}, {1.301186250351558e+06, -209862.50040545128}, {1.3011646242582486e+06, -209855.7799880111}, {1.301125498827964e+06, -209821.1540872159}, {1.3010497523729568e+06, -209733.51564353518}, {1.3009657524052807e+06, -209670.34371959744}, {1.3009398735478101e+06, -209658.34147407534}, {1.3008824979839148e+06, -209632.71988258488}, {1.3007848734199437e+06, -209628.23610407393}, {1.3007297502459562e+06, -209637.29816696583}, {1.3005727497438365e+06, -209574.1419940067}, {1.3004946248910944e+06, -209542.49827845045}, {1.3004588754205084e+06, -209520.1423898097}, {1.3004489995570667e+06, -209514.0625121568}, {1.3004259978783126e+06, -209481.92001561867}, {1.300392999578616e+06, -209281.59382231417}, {1.3003973731002784e+06, -209245.3770727031}, {1.3003886260569538e+06, -209192.48528731847}, {1.3003737518830416e+06, -209164.1387765687}, {1.3003381231699563e+06, -209134.06490852404}, {1.3002783744586525e+06, -209069.45439522807}, {1.3002443733466659e+06, -209016.01657592645}, {1.3001745020065927e+06, -208840.14115138678}, {1.3001739979752847e+06, -208791.45487722848}, {1.300184372619708e+06, -208758.95535851386}, {1.3002547479910892e+06, -208660.1232195343}, {1.3002711237582737e+06, -208618.93966140877}, {1.3002639990657219e+06, -208558.529409013}, {1.3002480013220184e+06, -208540.61004594783}, {1.300214877014495e+06, -208525.5311093165}, {1.3001621269879155e+06, -208470.02991184779}, {1.300137124934908e+06, -208397.13963425253}, {1.3000907488042447e+06, -208363.70555748767}, {1.3000269993444332e+06, -208361.3586617096}, {1.2999911238660202e+06, -208380.07607434574}, {1.299884248227417e+06, -208505.43811123562}, {1.2998487507724846e+06, -208521.54611178744}, {1.2998150016761525e+06, -208519.40397872846}, {1.2997787481742585e+06, -208502.26691425592}, {1.299761873626092e+06, -208474.23542307387}, {1.2997393759786459e+06, -208403.51353016845}, {1.2997279985219329e+06, -208318.11172541697}, {1.2997011273528244e+06, -208278.90754024056}, {1.2996659974207212e+06, -208189.7044993746}, {1.299650750473654e+06, -208158.85883338936}, {1.2996235012810645e+06, -208129.96628872282}, {1.2995807478754274e+06, -208119.02985940408}, {1.299529625449947e+06, -208135.14311028225}, {1.299468501153198e+06, -208232.43690370698}, {1.2994341272680569e+06, -208317.6549470441}, {1.2993646234508124e+06, -208421.46964551625}, {1.2992927517364854e+06, -208515.40848054714}, {1.2992671248946683e+06, -208529.87312902207}, {1.2992138760871072e+06, -208533.48535339604}, {1.2991543741411315e+06, -208527.87275476824}, {1.299113127579092e+06, -208480.7353268168}, {1.2990884982992392e+06, -208405.23563713743}, {1.2990756244995804e+06, -208389.3744019135}, {1.2990746269376166e+06, -208353.6249313273}, {1.2990916274936097e+06, -208332.85989150242}, {1.299145249074326e+06, -208306.51375500648}, {1.2992687524957675e+06, -208244.7331674921}, {1.299287375402533e+06, -208187.78288001264}, {1.2992778775625727e+06, -208143.1236059924}, {1.2992442492237412e+06, -208112.71896740166}, {1.2991861228632098e+06, -208099.17312599882}, {1.299090876696974e+06, -208112.2674393549}, {1.299054124414098e+06, -208133.70452092378}, {1.299017750154703e+06, -208165.3429861539}, {1.298995877296066e+06, -208168.93945954973}, {1.2989396253019609e+06, -208155.06284760102}, {1.2989018754571215e+06, -208127.92391185998}, {1.2988591273018103e+06, -208083.611159364}, {1.2988541237410135e+06, -208040.7947498134}, {1.2988672495563263e+06, -207871.8287544544}, {1.298837873981656e+06, -207784.26381533942}, {1.298796123388309e+06, -207750.04743998195}, {1.2987552495994247e+06, -207733.67167279753}, {1.2986896257731868e+06, -207723.92181718326}, {1.2986792511287634e+06, -207711.07951948117}, {1.2986590006208988e+06, -207687.0330258282}, {1.2986358729343177e+06, -207658.32949290192}, {1.2986311266395003e+06, -207650.53275860613}, {1.298629126265247e+06, -207633.76321696257}, {1.2986133752868716e+06, -207633.77896794095}, {1.2986117476857724e+06, -207623.78234699857}, {1.2985638752121637e+06, -207564.90518983128}, {1.298518375885963e+06, -207503.1088513385}, {1.2977351269842894e+06, -206386.13872049912}, {1.2968585010324805e+06, -205185.64115133486}, {1.2968291254578102e+06, -205159.68878929853}, {1.296264626143814e+06, -204377.57920839405}, {1.2960344990994236e+06, -204058.1861192237}, {1.2959613725571525e+06, -203957.2643504464}, {1.2959067481641467e+06, -203881.5493973957}, {1.2953027506467113e+06, -203040.43665149715}, {1.295286873660509e+06, -203018.2330223138}, {1.2952578761093197e+06, -202978.51430517714}, {1.2952413743343083e+06, -202931.6078915752}, {1.2952177478667456e+06, -202866.62460512458}, {1.2951736241259896e+06, -202742.9689242253}, {1.2948987485520346e+06, -201980.09128791722}, {1.294890752305346e+06, -201956.17080209102}, {1.294609376827648e+06, -201174.67025901726}, {1.2942202489068834e+06, -200146.51464491058}, {1.2937453726598434e+06, -198889.07728891936}, {1.2937418759426442e+06, -198880.23573972448}, {1.2936535024533058e+06, -198631.68530096067}, {1.2936371266861213e+06, -198585.60843888647}, {1.2936007524267267e+06, -198484.21939108404}, {1.2934974995131497e+06, -198194.48539419472}, {1.2933073747035065e+06, -197661.9238140178}, {1.2932947476691753e+06, -197625.9380787562}, {1.292990622528377e+06, -196691.64254478854}, {1.2928986263140123e+06, -196458.63832168118}, {1.292890498809171e+06, -196438.15679946705}, {1.292871377121423e+06, -196425.04673513258}, {1.2928092500123843e+06, -196419.81215998577}, {1.2927341230958598e+06, -196418.42082356266}, {1.2926643725132872e+06, -196403.76716334745}, {1.2926254990986567e+06, -196340.4219786476}, {1.2925399975377088e+06, -196250.91966919252}, {1.2924874995267838e+06, -196212.8915570681}, {1.292455372781224e+06, -196153.57862283266}, {1.2923999975915821e+06, -195994.56199548068}, {1.2923948732732842e+06, -195979.9975908096}, {1.2923752475542286e+06, -195959.68932935758}, {1.2922856244872725e+06, -195927.32631912222}, {1.2922233766207327e+06, -195905.001932438}, {1.292204874471468e+06, -195874.6865493916}, {1.292071873210066e+06, -195893.89224235737}, {1.292064375744359e+06, -195902.37676937552}, {1.2920118724831077e+06, -195939.18680583872}, {1.2919295001165308e+06, -195968.0793505055}, {1.2918456261566817e+06, -195983.91958442493}, {1.2917675013039396e+06, -195976.18585404265}, {1.2916933771997052e+06, -195960.0936044692}, {1.291596498182044e+06, -195963.09154068655}, {1.2915427505935011e+06, -195946.23274349887}, {1.291494626104238e+06, -195918.18550133822}, {1.2914373765481696e+06, -195896.76417074772}, {1.2913967495246134e+06, -195864.92094279872}, {1.291278249663969e+06, -195702.1083296584}, {1.2912700014016265e+06, -195685.48579714634}, {1.2911419984506955e+06, -195526.81044099247}, {1.291106002214782e+06, -195506.60718606296}, {1.291080375372965e+06, -195470.1699227544}, {1.2910659999800343e+06, -195449.0006078179}, {1.2910266225340958e+06, -195411.82829885208}, {1.2910216242236248e+06, -195381.42366026132}, {1.2910183742717532e+06, -195361.84519414068}, {1.2910252521989774e+06, -195311.9828469304}, {1.2910155023433627e+06, -195264.8139170222}, {1.2909693729780274e+06, -195203.09633342107}, {1.2909506240634345e+06, -195167.65663207648}, {1.2909358758973489e+06, -195065.28052296257}, {1.290930751579051e+06, -195029.767317052}, {1.2908788731066086e+06, -194912.51703402563}, {1.2908652485103137e+06, -194895.51647803234}, {1.2908592473875526e+06, -194887.51498101768}, {1.2908076261810903e+06, -194854.90520545444}, {1.2905303774597268e+06, -194741.12538799667}, {1.290462627251408e+06, -194713.2986595335}, {1.2904527513879663e+06, -194707.6230569922}, {1.2904144975118185e+06, -194685.67144346307}, {1.2902348733544257e+06, -194647.89009666652}, {1.2901513774180575e+06, -194620.46764331497}, {1.290071000175408e+06, -194569.4712256617}, {1.2900210013197185e+06, -194559.67411711207}, {1.2899749979622099e+06, -194510.75157827814}, {1.2899663769267122e+06, -194491.62464020425}, {1.2899481267931014e+06, -194471.51589114498}, {1.2898946259698863e+06, -194364.7977623255}, {1.2898802505769557e+06, -194347.46643578634}, {1.2898566241093925e+06, -194319.6869602583}, {1.2898412511544982e+06, -194317.0617971958}, {1.2898317480642116e+06, -194304.5135177567}, {1.289806373238049e+06, -194270.15538359387}, {1.289739247818539e+06, -194179.78152000182}, {1.2896447524489388e+06, -194084.87662496394}, {1.2895645012141163e+06, -194064.2008406832}, {1.2895413735275352e+06, -194047.87757676025}, {1.289481624816231e+06, -193977.67021581484}, {1.2894281239930158e+06, -193945.3754598191}, {1.2893602477768702e+06, -193938.4817816168}, {1.28927037269426e+06, -193950.59428398754}, {1.2892436275329785e+06, -193945.1234441651}, {1.289181626431767e+06, -193973.23369023902}, {1.289146123726509e+06, -193955.93911598297}, {1.2891219984779637e+06, -193920.95094268513}, {1.2890885013972856e+06, -193823.79890806554}, {1.2890563746517259e+06, -193798.2508211406}, {1.288987747638944e+06, -193786.35883246711}, {1.2889187478530076e+06, -193738.60711635905}, {1.2889042517025764e+06, -193712.74926019274}, {1.2888291247860515e+06, -193635.64297071914}, {1.2888233756789444e+06, -193629.3268283906}, {1.288695750751495e+06, -193497.90591515228}, {1.2886338756581102e+06, -193464.40883447393}, {1.2884516263376544e+06, -193473.62315682368}, {1.2884076233543996e+06, -193516.71783365868}, {1.288315747897536e+06, -193629.21657154197}, {1.2882618743011658e+06, -193673.93884947593}, {1.288165499314813e+06, -193725.57580691646}, {1.288035249224301e+06, -193757.0935146457}, {1.2880083728048662e+06, -193779.45465361257}, {1.287930247952124e+06, -193897.39272936154}, {1.2878568746445253e+06, -193947.85886407644}, {1.2878033738213102e+06, -193995.08029724588}, {1.2877297484980575e+06, -194094.32721198932}, {1.2875672509044847e+06, -194195.23322978825}, {1.287536126971215e+06, -194254.20489282557}, {1.2875205020006667e+06, -194267.01568857091}, {1.2874612520703445e+06, -194358.7651376077}, {1.2873412506164284e+06, -194498.93834449654}, {1.287288500589849e+06, -194538.32629108732}, {1.2872236275602467e+06, -194674.6247572957}, {1.2871618732243632e+06, -194733.45466152788}, {1.287049626502134e+06, -194813.32787286956}, {1.2869251255187285e+06, -194879.81275259214}, {1.2869103773526428e+06, -194868.95507816528}, {1.2868533745619026e+06, -194940.68503368692}, {1.2868116239685556e+06, -194993.6713249418}, {1.286807623220048e+06, -195077.28276848467}, {1.2868010025588041e+06, -195103.1721266075}, {1.286741626620655e+06, -195144.48694288637}, {1.2867388754497655e+06, -195215.0618266603}, {1.2867573775990303e+06, -195257.37420490268}, {1.286755377224777e+06, -195395.40527873253}, {1.2867618771285196e+06, -195439.67077829363}, {1.2867287475706702e+06, -195557.9553755666}, {1.2866818726590248e+06, -195595.54771062266}, {1.2866733776313546e+06, -195652.4979981021}, {1.2866916225146395e+06, -195735.06462674588}, {1.2866879997896128e+06, -195838.2650370614}, {1.2866348769898787e+06, -195925.60946247913}, {1.2865397515811436e+06, -196026.21621168894}, {1.2864460017578532e+06, -196094.517704251}, {1.2863235011487016e+06, -196261.15780513664}, {1.2863116249110065e+06, -196334.07958468865}, {1.286273502293012e+06, -196392.8727366377}, {1.286249875825449e+06, -196410.82885198575}, {1.2862084980052565e+06, -196403.45214377996}, {1.286087000208395e+06, -196455.33061622246}, {1.286022751967602e+06, -196449.52900585416}, {1.2859443750992059e+06, -196498.23628131696}, {1.2858157526097922e+06, -196540.12338314322}, {1.2857271271047997e+06, -196593.8919729907}, {1.2856862480655895e+06, -196597.14192486228}, {1.285665252011415e+06, -196627.4835595393}, {1.2856443767147418e+06, -196670.23696517642}, {1.2855968770142877e+06, -196688.21933215484}, {1.2855371230526576e+06, -196705.2356391265}, {1.2855063771428685e+06, -196734.17018640204}, {1.285455748248044e+06, -196736.85835337825}, {1.2854416248707674e+06, -196737.45164023037}, {1.2853753762557204e+06, -196710.6119730787}, {1.2853164990985533e+06, -196716.78110627574}, {1.2852750005208603e+06, -196763.29899574444}, {1.2852838735720115e+06, -196821.71937453863}, {1.2853073740317477e+06, -196899.14068357996}, {1.2852635023066462e+06, -196943.46918705455}, {1.285107252601162e+06, -196924.42100387253}, {1.2850203754547695e+06, -196900.5162690247}, {1.2849771232681507e+06, -196839.55998271191}, {1.2848250003190008e+06, -196883.14293987677}, {1.2848167520566583e+06, -196887.03343153535}, {1.2847827509446722e+06, -196869.92261869367}, {1.2847548769632736e+06, -196837.23408823856}, {1.2846952490094705e+06, -196876.43827341497}, {1.2846700001911349e+06, -196909.20555876195}, {1.2846721265732157e+06, -196981.12452602386}, {1.2846769988758597e+06, -197027.7946749502}, {1.2846647498650094e+06, -197056.73447255208}, {1.2847004993355959e+06, -197117.20247853524}, {1.284751248987921e+06, -197170.49853903148}, {1.2847875024898155e+06, -197204.81467058533}, {1.284800749062629e+06, -197244.1396132626}, {1.2847943751667133e+06, -197289.20316239446}, {1.2847891248405878e+06, -197319.5605480501}, {1.2848214983514757e+06, -197367.74804122653}, {1.2848513727071276e+06, -197417.2008629993}, {1.2848828746638782e+06, -197477.50085854647}, {1.284884875038132e+06, -197522.9371808332}, {1.2849196269467543e+06, -197569.02979388577}, {1.2849179993456556e+06, -197630.42185726692}, {1.2848720012384732e+06, -197702.92361072893}, {1.2847963755409666e+06, -197744.71620668517}, {1.2847325000733286e+06, -197744.85796549055}, {1.2846917522922712e+06, -197787.81088352017}, {1.284632250346295e+06, -197835.98262571823}, {1.284537376953214e+06, -197850.57853234606}, {1.2844435011220966e+06, -197893.18492885167}, {1.284362877114119e+06, -197974.7329942272}, {1.2843562512025489e+06, -198009.15413230355}, {1.2843915018921532e+06, -198058.59120309772}, {1.2844071268627015e+06, -198116.76481656427}, {1.2843897482832274e+06, -198160.64179199212}, {1.2843652502615275e+06, -198177.87336233468}, {1.2843920006731353e+06, -198199.62546347128}, {1.2844249989728318e+06, -198235.29617916537}, {1.2844171234836439e+06, -198278.9053879606}, {1.2844193758735517e+06, -198326.01656428142}, {1.2844591260926449e+06, -198353.32876078459}, {1.2844448767075413e+06, -198370.18755797227}, {1.28439062508769e+06, -198387.98616353655}, {1.284271752453891e+06, -198523.6230886532}, {1.2842401244893135e+06, -198525.76522171218}, {1.2842243735109381e+06, -198566.81227135845}, {1.2840281268210327e+06, -198670.1386895012}, {1.2839887493750942e+06, -198691.50226650434}, {1.2839221227365662e+06, -198788.70155405905}, {1.283832751685264e+06, -198812.2177647734}, {1.2837536240202324e+06, -198827.64322292898}, {1.283660000204769e+06, -198867.65595832863}, {1.283576751033729e+06, -198865.7973428804}, {1.283334999767297e+06, -198936.2987220888}, {1.2832554993291101e+06, -198983.42039906187}, {1.2831381230382565e+06, -199006.3433229241}, {1.2831007512168982e+06, -199032.08042158955}, {1.28306350015304e+06, -199112.95119489497}, {1.2830351273906599e+06, -199122.6852995311}, {1.2830073741667625e+06, -199181.93522985303}, {1.282902750918067e+06, -199228.87314541172}, {1.2828447505653626e+06, -199282.75199210807}, {1.2827118753117877e+06, -199290.21795585798}, {1.2826397515818067e+06, -199340.4215742664}, {1.2825923726388537e+06, -199392.57831399352}, {1.2825653754619178e+06, -199393.96965041663}, {1.2824508763497812e+06, -199468.57678465475}, {1.2824136252859235e+06, -199503.2656893637}, {1.282349875826112e+06, -199559.36017368454}, {1.282311249176809e+06, -199593.44004056277}, {1.2821697476374106e+06, -199669.84278633562}, {1.2821361245489055e+06, -199684.2969341583}, {1.282103000241382e+06, -199669.564519051}, {1.2820331236509825e+06, -199674.91985169868}, {1.281994875025161e+06, -199678.1383016135}, {1.2819601231165389e+06, -199711.1576026145}, {1.2819249984347615e+06, -199713.42049317434}, {1.2818218767793379e+06, -199719.46886887052}, {1.2817821265602442e+06, -199721.65825486463}, {1.281683499183984e+06, -199747.4846090742}, {1.2815836274804315e+06, -199736.31191507983}, {1.2815457516277647e+06, -199766.8425614976}, {1.2815380021464042e+06, -199794.61153637338}, {1.2815047518310538e+06, -199811.96911454317}, {1.281472625085494e+06, -199828.29762879224}, {1.2814043760961932e+06, -199818.00173926097}, {1.2813859999547554e+06, -199826.95354530425}, {1.2813239988535438e+06, -199914.82825366058}, {1.2813047511579688e+06, -199921.811187407}, {1.2812116261234875e+06, -199926.65723842056}, {1.2811601256745257e+06, -199927.74930625455}, {1.281142626337551e+06, -199937.8456833933}, {1.281111623161782e+06, -199989.90791724995}, {1.281045374546735e+06, -200051.53099498083}, {1.2809848750387952e+06, -200060.0627749341}, {1.2809650025544115e+06, -200063.29697582708}, {1.2808431267340686e+06, -200100.99956773175}, {1.2808197522821594e+06, -200124.88855160098}, {1.2807996225317959e+06, -200168.76552702882}, {1.280773250143669e+06, -200186.71639205073}, {1.2806988740237807e+06, -200198.34586441773}, {1.2806536267132345e+06, -200204.00046565454}, {1.280570876323176e+06, -200269.14126188913}, {1.2805381247888072e+06, -200268.87349525676}, {1.2805167507111519e+06, -200292.01693281624}, {1.2804794996472942e+06, -200310.03080175165}, {1.280461874302492e+06, -200339.8264025119}, {1.28045087486926e+06, -200359.99815548467}, {1.280401248786725e+06, -200398.38854011148}, {1.2803699988456285e+06, -200432.53141090344}, {1.2803501263612448e+06, -200460.9671771971}, {1.280307252198107e+06, -200469.62496497738}, {1.2802468734476678e+06, -200466.17025038716}, {1.2802256253778394e+06, -200477.75246981904}, {1.2801688746027527e+06, -200480.514141361}, {1.280150372453488e+06, -200492.5006359045}, {1.2801102494612397e+06, -200525.93996299547}, {1.2799938759826762e+06, -200581.12614089693}, {1.2799784977774555e+06, -200608.0025603315}, {1.2798911271004071e+06, -200606.74773238762}, {1.2798628750955276e+06, -200638.26544011664}, {1.2797980020659259e+06, -200674.01491070283}, {1.2797609977673958e+06, -200672.7338311281}, {1.2797457508203285e+06, -200683.74901533872}, {1.2797306246307618e+06, -200712.27928750264}, {1.2796713747004396e+06, -200770.6419127097}, {1.2796411275716326e+06, -200781.93536420492}, {1.2796013773525394e+06, -200788.37751436047}, {1.279551126481196e+06, -200839.70470255963}, {1.2793469990517767e+06, -200886.43785539945}, {1.2793006229211134e+06, -200876.8612605473}, {1.2792519996508686e+06, -200850.09509796137}, {1.2792253752470878e+06, -200862.51736957347}, {1.279206752340322e+06, -200885.63980582845}, {1.2791848742313585e+06, -200919.11063487618}, {1.279165001746975e+06, -200960.37294789357}, {1.2791262490898455e+06, -200969.2039964362}, {1.2790980023352923e+06, -201004.5806938673}, {1.2789874987213365e+06, -201066.49778986094}, {1.2789086230719588e+06, -201092.093129721}, {1.2787891256493507e+06, -201127.6850905232}, {1.2787148755372888e+06, -201190.15872108634}, {1.2786859987436007e+06, -201247.42402813304}, {1.2786526224204232e+06, -201268.22056991467}, {1.2786026235647337e+06, -201287.00098646432}, {1.278485126516379e+06, -201364.5798052894}, {1.2783693725762982e+06, -201439.74872442288}, {1.2783216261105165e+06, -201506.48561979947}, {1.2781877480446515e+06, -201554.64161101915}, {1.2780388750473731e+06, -201568.45521905436}, {1.2779293742457074e+06, -201707.18983658496}, {1.2778207502485048e+06, -201797.43769235}, {1.2776705016657817e+06, -201870.04445233452}, {1.2774973774121315e+06, -201919.40801856294}, {1.2773451232048287e+06, -201912.7978579714}, {1.27726612679795e+06, -201967.04947782238}, {1.2772288757340922e+06, -201959.81452842196}, {1.2771443769854344e+06, -201895.6712941511}, {1.2770376273546582e+06, -201955.25199501915}, {1.2769934983635764e+06, -201952.1070496703}, {1.2769123755746167e+06, -201955.81377991452}, {1.2768902507003257e+06, -201986.76445242227}, {1.2768972493850505e+06, -202047.20095644868}, {1.2767856274516298e+06, -202122.95266178204}, {1.2766973747197925e+06, -202225.70154405106}, {1.2766918723780136e+06, -202250.54608727503}, {1.2766996271097003e+06, -202298.45531316707}, {1.276683251342516e+06, -202399.86011194787}, {1.2766215022569583e+06, -202438.48676125053}, {1.276520249717635e+06, -202431.33056674176}, {1.2764506251428896e+06, -202345.529737205}, {1.2764088745495426e+06, -202348.42266689986}, {1.2763271269717743e+06, -202407.35757765453}, {1.2763026236997484e+06, -202394.6570387578}, {1.2762713737586513e+06, -202369.76524259849}, {1.2762348734914297e+06, -202388.06262914464}, {1.276226126448105e+06, -202422.81453776686}, {1.2762026259883689e+06, -202436.89066210832}, {1.2761435020658737e+06, -202437.87247309368}, {1.2760142495373255e+06, -202543.82930462505}, {1.2759885019380078e+06, -202586.4672030874}, {1.2759212505106707e+06, -202625.1253543466}, {1.275895124887872e+06, -202669.95263880305}, {1.27588974855392e+06, -202737.93911179737}, {1.2758567502542236e+06, -202812.09471798874}, {1.2757748766686283e+06, -202865.09150989586}, {1.2757176271125595e+06, -202873.04575397563}, {1.275667250233389e+06, -202923.9371651064}, {1.2756712509818962e+06, -202991.25159635674}, {1.275661501126282e+06, -203014.64179924433}, {1.275570250458227e+06, -203073.40869956277}, {1.275560001821631e+06, -203161.8609437931}, {1.2755312510357695e+06, -203178.0319482584}, {1.275498247485747e+06, -203197.0328785053}, {1.2754172507046144e+06, -203192.59635292948}, {1.2752941253066543e+06, -203151.3130386076}, {1.275275749165216e+06, -203150.87726153922}, {1.2751949991494115e+06, -203198.95449786703}, {1.2751309976739464e+06, -203190.88999693887}, {1.2750560020155748e+06, -203210.70472773514}, {1.2750331263446477e+06, -203246.4541983211}, {1.2750164985618093e+06, -203333.34184536594}, {1.2749556262807143e+06, -203509.04925946984}, {1.2749369981236225e+06, -203549.25100661}, {1.2748914987974223e+06, -203571.54914166336}, {1.2747551268266477e+06, -203556.79572525178}, {1.2746694992578733e+06, -203528.28120406624}, {1.2746086269767783e+06, -203560.32919473387}, {1.2745936267950386e+06, -203594.37755965535}, {1.2745693755386667e+06, -203658.99857360357}, {1.2745271261643376e+06, -203679.9211232122}, {1.274448376522787e+06, -203643.43660696875}, {1.2743753759883433e+06, -203688.57891099248}, {1.2743392484942758e+06, -203637.95526649407}, {1.2742866244755238e+06, -203640.47017270792}, {1.2741939982220242e+06, -203687.03006478562}, {1.274085374224821e+06, -203789.62668759702}, {1.2740122476825505e+06, -203809.5306739374}, {1.2739308728779368e+06, -203849.1548852038}, {1.2738666246371437e+06, -203893.7196533538}, {1.2738036259739683e+06, -203917.12560721976}, {1.2737523775406606e+06, -203971.10946043837}, {1.2736387499826606e+06, -204038.60765310307}, {1.2735734989295774e+06, -204136.32672294392}, {1.273498624028707e+06, -204174.4703422431}, {1.2733728734676838e+06, -204239.18586206157}, {1.2733087512347177e+06, -204238.40881379507}, {1.2731878729763385e+06, -204337.81323832227}, {1.2731256251097992e+06, -204348.28238861565}, {1.273060374056716e+06, -204428.9063965932}, {1.273065498375014e+06, -204457.14265049412}, {1.2731363725273772e+06, -204478.64273597673}, {1.273138498909458e+06, -204521.46964617935}, {1.273108251780651e+06, -204557.56038796343}, {1.2731178756284383e+06, -204731.29892977024}, {1.2730332508719536e+06, -204839.82842110307}, {1.2729221224691886e+06, -204868.42169718049}, {1.2728277478570896e+06, -205064.45312371454}, {1.2727946235495661e+06, -205087.3130436635}, {1.2727348748382619e+06, -205096.5011143824}, {1.2725939980876725e+06, -205084.54612179543}, {1.2725079977457426e+06, -205104.37660357007}, {1.272459001702343e+06, -205083.20203830744}, {1.2723678770421152e+06, -204893.51825605868}, {1.2723317495480482e+06, -204884.39318925305}, {1.2722782487248331e+06, -204895.12485585292}, {1.2722644981207112e+06, -204931.96639427287}, {1.2721191270909584e+06, -204976.73592514195}, {1.2720690022274419e+06, -205066.46924894676}, {1.2720473761341325e+06, -205097.7191900434}, {1.271989249773601e+06, -205137.85793327005}, {1.2719680017037727e+06, -205179.33025933243}, {1.2719233739317092e+06, -205207.01522899047}, {1.2718791241831263e+06, -205210.73245988693}, {1.2718374995976062e+06, -205252.48305323394}, {1.2717958750120862e+06, -205285.6861156493}, {1.2717477505228235e+06, -205283.15545845707}, {1.2717092498813476e+06, -205310.719670614}, {1.2716974996514795e+06, -205356.21899681445}, {1.2716349997692863e+06, -205412.01421254617}, {1.2715680003576032e+06, -205444.17246006266}, {1.271539627595223e+06, -205496.18744098442}, {1.271408626708075e+06, -205574.5485584021}, {1.27137612718936e+06, -205618.2522730676}, {1.2713871266225926e+06, -205648.12662871974}, {1.2713936265263353e+06, -205668.01486408175}, {1.271425002475259e+06, -205769.84493927867}, {1.2714098762856927e+06, -205811.17025620956}, {1.2713565014703046e+06, -205851.82878172258}, {1.2713501275743884e+06, -205913.56211630185}, {1.2713573730244413e+06, -205958.56266152044}, {1.271342000069547e+06, -206011.47019788343}, {1.2712352504387707e+06, -206122.267830102}, {1.2711341239072746e+06, -206166.73284205585}, {1.2710788747254596e+06, -206250.43879146897}, {1.2710518775485242e+06, -206277.4359684044}, {1.2710137496802034e+06, -206315.62684063846}, {1.2709226250199755e+06, -206320.43613936915}, {1.2708908762978967e+06, -206343.07554562087}, {1.2708666250415249e+06, -206421.34215716808}, {1.2708372494668546e+06, -206479.93579672463}, {1.2707527507181969e+06, -206623.4849633118}, {1.270716749231957e+06, -206649.78384687263}, {1.2706637524400498e+06, -206688.6415105248}, {1.2705946266462863e+06, -206766.45134369936}, {1.270517877378989e+06, -206818.545079513}, {1.2704998740107059e+06, -206909.92175539467}, {1.2704534978800425e+06, -206930.62379130605}, {1.2702853771871896e+06, -206880.26791344}, {1.270231125567339e+06, -206801.34501112695}, {1.270235126315846e+06, -206732.73374932376}, {1.270211373840456e+06, -206690.80989521462}, {1.2701330022223862e+06, -206686.29461474693}, {1.270103500639889e+06, -206655.12342854193}, {1.2700759994316455e+06, -206666.39062840655}, {1.2700241262095291e+06, -206712.32573167537}, {1.2699973757979218e+06, -206710.6561279674}, {1.2698714992290717e+06, -206783.03187360242}, {1.2697525005874452e+06, -206847.8734012479}, {1.269731373275118e+06, -206882.04777399637}, {1.2697116267985613e+06, -206907.43835113756}, {1.2696442493633972e+06, -206937.07644211384}, {1.2695171232169294e+06, -207069.92019373202}, {1.269509373735569e+06, -207098.09344371944}, {1.2695293774781055e+06, -207159.00247709733}, {1.2695116261254763e+06, -207192.62556560268}, {1.2695164984281207e+06, -207214.49842423992}, {1.2695398728800295e+06, -207249.23458188376}, {1.2695354993583676e+06, -207273.43858532072}, {1.2695489979468351e+06, -207323.4216900319}, {1.2695865010263468e+06, -207387.50192038924}, {1.2696830020205271e+06, -207466.49832726805}, {1.2696109990480468e+06, -207539.60911856033}, {1.269568376900563e+06, -207622.1232439431}, {1.2695399988878565e+06, -207687.3742970263}, {1.2694891232277043e+06, -207709.64093012293}, {1.2694205014652484e+06, -207715.096018967}, {1.2693370002785544e+06, -207716.12508288748}, {1.2692861246184018e+06, -207696.0793377417}, {1.2691863736723503e+06, -207703.09377344488}, {1.2691483770621829e+06, -207678.0024648928}, {1.2691127483490976e+06, -207752.96662130742}, {1.2690447513754512e+06, -207766.4547091229}, {1.268956372635787e+06, -207733.60866888403}, {1.2688489982162016e+06, -207807.24974311516}, {1.2687863775765072e+06, -207810.90397009836}, {1.2687298735667486e+06, -207947.34419511212}, {1.2686342493770313e+06, -207978.9511583855}, {1.2686306266520051e+06, -208037.23502870067}, {1.2685559985164623e+06, -208136.82846496836}, {1.2685012481156294e+06, -208224.26739625633}, {1.268455250008447e+06, -208251.73185221688}, {1.2683418744661012e+06, -208210.9368182246}, {1.2683034998324523e+06, -208222.23552004597}, {1.2681701257978957e+06, -208341.92195439432}, {1.2681537500307113e+06, -208291.1092981554}, {1.26810787268103e+06, -208234.34277209034}, {1.2681058775571026e+06, -208182.96833095606}, {1.268077877567877e+06, -208152.82620867155}, {1.2680340005924492e+06, -208164.12491049292}, {1.2679837497211057e+06, -208211.51435409836}, {1.2679431226975494e+06, -208280.87641253741}, {1.2678299991708575e+06, -208357.14264983125}, {1.2678007496040142e+06, -208361.4059146447}, {1.2677608733770936e+06, -208388.733862126}}})

	intersection := Construct(a, b, INTERSECTION)
	union := Construct(a, b, UNION)
	drawShapes(b, a, intersection, "DifficultShapes6.png")
	drawShapes(b, a, union, "DifficultShapes6union.png")
}

var spiral = geom.T(geom.LineString{
	{158.69048, 156.42586}, {144.01645, 156.42586}, {139.1901, 161.57183}, {139.1901, 169.9358}, {139.1901, 180.95427}, {150.53931, 194.58874}, {169.42641, 194.58874}, {194.23167, 192.66117}, {210.35714, 175.22916}, {210.35714, 147.61905}, {210.35714, 139.5671}, {202.97619, 92.261905}, {151.64502, 92.261905}, {100.31385, 92.261905}, {84.545455, 139.9026}, {84.545455, 163.72294}, {84.545455, 187.54329}, {106.35281, 238.87446}, {162.38095, 238.87446}, {218.40909, 238.87446}, {248.2684, 188.54978}, {248.2684, 150.63853}, {248.2684, 112.72727}, {216.3961, 58.376623}, {153.65801, 58.376623}, {90.919913, 58.376623}, {54.015152, 113.39827}, {54.015152, 160.36797}, {54.015152, 207.33766}, {92.597403, 267.05628}, {162.38095, 267.05628}, {232.1645, 267.05628}, {274.77273, 201.6342}, {274.77273, 152.31602}, {274.77273, 102.99784}, {233.171, 34.220779}, {154.6645, 34.220779}, {76.158009, 34.220779}, {30.194805, 103.66883}, {30.194805, 159.69697}, {30.194805, 215.72511}, {76.829004, 288.52814}, {163.38745, 288.52814}, {249.94589, 288.52814}, {295.90909, 210.35714}, {295.90909, 151.64502}, {295.90909, 92.9329}, {243.90693, 13.084415}, {155.3355, 13.084415}, {119.40098, 13.084415}, {97.739911, 26.744043}, {97.739911, 26.744043}})

func TestLine(t *testing.T) {
	shape := geom.T(geom.Polygon{
		{{0, 0}, {0, 200}, {200, 200}, {200, 0}, {0, 0}}})
	FixOrientation(shape)

	intersection := Construct(spiral, shape, INTERSECTION)
	drawLine(spiral, shape, intersection, "line.png")
}

func TestLines(t *testing.T) {
	line := geom.T(geom.LineString{
		{0, 0}, {200, 200}, {100, 200}, {300, 330}, {100, 50}})

	intersection := Construct(spiral, line, INTERSECTION)
	drawLines(spiral, line, intersection, "lines.png")
}

// The clipper doesn't work will if a shape is made up of only two points.
// To get around this problem, if there are only 2 points, we add a third
// one a small distance from the second point.
func TestDifficultLine1(t *testing.T) {
	line := geom.T(geom.MultiLineString{[]geom.Point{
		{0, 1}, {2, 1.1}}})

	shape := geom.T(geom.Polygon{
		{{1, 0}, {2, 0}, {2, 2}, {1, 2}, {1, 0}}})

	intersection := Construct(line, shape, INTERSECTION)
	drawLine(line, shape, intersection, "difficultLine1.png")
}

// srg MULTILINESTRING((-10219.8583984375 485656.53125,-10222.962890625 486884.46875))

//input POLYGON((-10316.863945857855 464773.6555141624,-9978.55918198498 464769.37649837043,-8741.351332553895 464757.1852411078,-8531.81081689964 464754.81209369935,-7919.570287447888 464756.6549581692,-7165.812467619078 464763.93716050475,-6461.255453909049 464761.1544876585,-6280.260961397085 464760.5612008063,-5912.192098720698 464760.2514315649,-5566.594631860033 464759.96791395417,-5531.364943560213 464762.4985711465,-4851.715476987883 464758.6238304662,-3957.6584424432367 464753.84603369224,-3920.0031034736894 464753.8145317355,-2426.4638319613878 464754.8435956561,-2341.4348003647756 464755.2478707677,-1329.54469659389 464749.0629865923,-754.9700067637023 464752.7802174889,-699.6945733183529 464753.2212448834,-606.1600133990869 464753.625519995,-190.10842026514 464758.2510573113,-26.723521576961502 464760.3774393919,271.49500233051367 464748.5327036537,847.8968056524172 464744.7524688436,2411.884953111876 464760.34593743517,2457.43678257335 464762.90809658426,2546.114790827036 464763.779650721,2854.0516683922615 464765.59626356035,3100.039948006859 464763.15486191213,3982.5620160545222 464756.3766908846,4038.435986678349 464758.9703519904,4798.263183507603 464760.6872086333,5273.228686091723 464761.87378233764,5596.354757137131 464762.53007310326,5677.740062402794 464765.15523616585,7194.968805391807 464761.0022282009,7278.779761327198 464764.87696888123,7309.14764763508 464766.18955041247,7954.790751895169 464766.43631574034,7974.831246714806 464766.4678176971,8811.796234974638 464766.9981006357,8892.577752735931 464767.1241084627,9924.508351326454 464766.75133530784,10258.565601364244 464766.37331182684,10496.657390486915 464766.7198333511,10557.398413428571 464764.283682029,10612.064809043426 464761.3750013558,10655.8000256659 464759.3431251453,10688.598812969401 464756.8439699097,11711.409595080651 464766.0320406287,11778.823782527354 464766.56232356734,11829.835951159243 464771.749645779,12014.479420328047 464772.0646653465,12032.698051982094 464772.5004424149,12118.3361214092 464773.49800437863,12138.990904385457 464773.93903177313,12499.76181374793 464778.37555734895,13567.525888142642 464780.7172028007,13716.325380855007 464783.53137760377,13745.480441828026 464783.19010640564,15168.58133804542 464773.75002003263,15320.420769584365 464776.5956967925,15965.46533666621 464770.7835857719,16000.085987135302 464770.4370642477,16106.378839538665 464769.4080003272,16128.85548568028 464769.4710042407,16484.17655652482 464766.43631574034,16681.578318177722 464764.37293757324,16731.991949631134 464764.06316833175,17144.389315782115 464770.09579304955,17496.082411274314 464760.34593743517,17827.703509989893 464762.84509267076,18367.657549350988 464766.31030791334,18535.289961874252 464767.59138748783,18705.962313224096 464768.4681919508,18946.47975301626 464769.9382832658,19132.330797193805 464771.2823667539,19165.12958449754 464772.21692480415,19247.123927593697 464772.001661433,19460.318670230918 464771.7181438223,19876.370263365097 464772.001661433,19934.675134984544 464773.43500046514,19944.99202582054 464776.00240994035,20008.153449105797 464778.71682854707,20051.85716377152 464788.59269198845,20060.373192746425 464783.0956005354,20840.267136026174 464775.56138254586,21592.848882802762 464762.939598541,21879.54819119186 464757.8730338303,22202.663761584787 464760.97072624415,22873.828701139195 464759.24861927505,23119.213193249656 464758.78134024993,23296.521956821438 464772.0646653465,23317.812029258814 464763.21786582563,23946.412574916612 464774.59532253887,24062.4185306516 464775.81339819985,24234.29845700995 464778.0920397382,24712.891934946645 464784.7809552216,24725.639726778492 464787.37461632735,24938.199179954594 464793.1867273479,26372.189252555603 464802.9365829623,26548.91522992775 464808.6541881126,27965.416466205847 464785.62625772774,28153.073622570373 464791.0025916798,28420.93476082268 464789.93677547644,28705.192667563446 464788.9392135127,29020.427498442587 464787.6581339381,29561.615364443045 464785.62625772774,29756.549472816987 464794.032029854,29827.633638225263 464789.24898275407,30071.15951488726 464798.3110456461,31028.39372369554 464798.53155934333,31156.54893408413 464798.2480417326,31356.34484445001 464806.71681777237,31919.36881680484 464810.4708009518,32863.82373182452 464816.813194911,33512.51202523708 464816.40366947325,34330.65984466439 464815.9993943616,34548.107351463055 464814.4978010899,35901.25290238927 464836.31290613976,36009.971405462595 464836.87469103513,36076.1727675742 464838.47079017723,36146.61639319523 464840.09314094984,36180.633256159956 464840.2506507336,37504.644747417886 464856.7524257449,37745.13593557966 464862.6537923096,38847.394652616465 464889.2519444595,39333.23883093195 464900.7501586735,39616.236659402726 464907.8118473118,39663.0013141993 464908.9039151459,39778.99151895568 464912.09611343,40770.73612138466 464932.0316017271,40854.552327646175 464932.49888075225,40874.59282246581 464932.5933866225,40937.712243142305 464940.9991587488,41908.80731292092 464959.6850694282,41928.84780774056 464959.8110772552,42386.74975041789 464970.1227177649,42544.01276884414 464978.6544977183,43552.70542400493 465005.4049093259,43563.63135267119 465007.19002020836,43561.24770461046 466008.0911913995,43559.47834470635 466604.50198758405,43558.44403045974 467078.09190472343,43558.26026904513 467310.62359847943,43558.276020023506 468215.0290258167,43558.19201480551 468430.62316749303,43557.98200176051 468566.6223651124,43557.183952189516 468900.0023230801,43555.54585043853 469574.77948700835,43555.20457924041 469833.62581530365,43545.54922949639 470327.4977422644,43544.68292568554 470471.5299388552,43543.275838284055 470604.531200257,43542.94506773818 470659.59137033136,43542.77180697606 470688.40516010614,43542.099765232066 470900.2190669724,43532.94319646992 471413.5959554879,43543.62761013443 471453.4669320822,43553.11494944268 471489.96719930414,43548.893687237985 472593.0607181948,43547.591606359 473010.34613796824,43546.189769283636 473344.15662267816,43540.71367913508 473547.4702515479,43522.978077484295 474276.43603141373,43518.98782962933 474535.68663482054,43527.59311414836 474718.31397875724,43526.78981425124 474851.7825191843,43526.091520876624 474867.0294662516,43531.86162928818 476124.4353202862,43538.030762484996 476307.49844129116,43533.237214732915 476700.1860831684,43519.754377243575 477730.46807935566,43518.74106430146 477797.404487125,43527.58261349611 477940.65438512317,43527.79787686723 478005.4696611379,43511.57436914067 479188.68840702425,43509.432236081455 479343.3105114094,43512.87119969353 479576.7820135419,43509.32197923283 480970.25006910926,43515.03433405701 481128.3111371064,43516.142152869375 481145.6897165807,43514.09977600677 481182.53125500074,43501.33098287042 481491.3134350721,43496.77369979373 482549.2488989604,43508.02514867997 482792.9375357324,43499.288606007816 483136.9389034512,43497.540247407975 483427.15593034413,43493.36098781251 484422.4077506246,43487.554127118085 484782.53286987357,43489.591253654566 485750.31498386734,43495.450617610244 485983.81273763045,43490.41555485618 486418.0934630709,43486.525063197594 487062.97001971665,43479.794145105174 488982.4367478044,43478.54981781356 489389.21626500133,43476.54944355972 489921.8460994179,43469.855277750175 491633.7516848007,43467.17761142645 492178.25250658614,43473.18923483975 492485.93736849737,43462.26330617326 493795.7204759562,43460.7774638799 494041.9082679637,43461.62276638602 494102.5337837306,43463.623140639625 494272.87536453444,43424.51346133347 495441.8447253172,43430.35707431077 495676.65506061155,43442.87385179312 497009.97012976324,43441.204248085385 497287.5338706946,43438.458327522036 497842.2518271195,43434.09005618584 498667.3773299672,43420.260697172256 499255.93888859474,43419.81966977776 499328.8134152116,43419.66215999401 499354.6870223562,43419.55715347151 499372.9056540105,43419.79866847326 499432.2500902029,43414.196570497705 499460.1870755147,43404.782735755434 500219.59424625407,43411.83392374148 500252.6870518208,43410.02781155426 500552.31266313,43408.70472937077 501572.8448037029,43406.04281402542 501613.4980788898,43385.84480942204 501656.62425768166,43400.85549181374 501671.9709609455,43397.28527004854 501763.4998962849,43397.85755559639 502169.50236521533,43394.12457372132 503088.78196646506,43391.91943674884 503454.93971043197,43391.599166855216 503507.9365023391,42721.0432651313 503500.9378176143,42708.32172493008 503505.9676300421,42561.56460908032 503497.4673520456,42050.43486014637 503502.0928893618,41678.32324635354 503494.81068702624,41466.257323833415 503497.00007302035,41141.209633426275 503501.0638254413,41129.0866304033 503507.77899255534,39566.21680240845 503499.43622434244,39172.30058421823 503502.37640697253,39161.98894370836 503509.9368765927,39110.6460045306 503508.3775297336,39045.40545209986 503506.74992863473,38708.93830237049 503499.8457497802,38562.13918391173 503499.06345118757,38548.241570658516 503499.4047223857,38524.07431950467 503499.7197419532,37912.03330244543 503508.75030288845,37635.94490315532 503507.72123896796,37514.51536053326 503507.09119983285,37126.06473183888 503505.09607590537,36850.58537037927 503503.657486547,36398.700301441364 503501.7831201204,36322.60732490965 503496.312280298,36056.79381384654 503494.96819681,35801.25519100996 503492.0017625493,35685.2702365797 503490.5946751478,35664.127173273824 503490.90444438916,35421.25233705132 503491.8127508088,35411.59173698095 503491.781248852,35265.38065504818 503492.75255918514,34877.533813858405 503491.7182449385,34721.06359467725 503491.3769737404,34434.74230976915 503482.37266443577,33153.34246534272 503488.65730480757,33118.90032596188 503488.90407013544,32837.98687696271 503487.1872134926,32551.02505226736 503485.906133918,32531.69335147459 503485.8116280477,32311.190154871205 503484.814066084,32060.47658174392 503483.685245967,32010.93975475314 503483.4699825959,31862.329273781274 503482.37266443577,31697.400779212592 503481.6586200828,31522.202646742808 503480.9078234469,31238.265009895666 503479.65824582905,30413.023999873083 503478.6554335392,29901.925752895884 503478.2196564708,29668.14448152203 503473.0008323024,29632.500017458573 503474.12440209324,29257.947002017638 503471.3417292469,28323.98223859584 503464.62656213285,28287.124949197518 503464.4690523491,28087.16102839564 503463.68675375637,28067.2255400985 503463.62374984287,26707.937107605627 503459.2817301374,26465.0780223615 503458.40492567455,25967.887889289763 503455.7482606552,25907.472386567853 503455.5329972841,25290.06028588256 503452.466806827,25111.23942838679 503451.4377429065,24855.09701804584 503447.99877929455,23498.817022422794 503448.52906223317,23251.122386817355 503447.7205120099,22526.78214426781 503443.7197635026,22469.390829393873 503443.12647665036,22300.235822294373 503442.59619371174,22050.13128699758 503440.968592613,21902.119343203958 503440.53281554463,21645.96118188463 503441.8768990326,21469.55547440634 503441.3413657679,21371.080357603263 503441.0315965265,20666.066565520363 503438.56394324766,20643.10688937502 503438.50093933416,20299.966575140832 503437.52962900104,20054.68708955287 503436.4060592102,19769.536627370864 503436.4690631237,19495.270091246115 503433.5918844071,19320.680996606825 503431.8435258075,19265.699581424473 503434.68920256733,19229.440829204395 503436.68957682094,19158.16765205562 503431.4077487391,18955.788581236266 503430.03216329427,18781.803274101578 503429.1553588314,18706.287833443843 503428.5305700225,18694.206833029864 503428.4990680658,18520.21627556905 503427.62751392904,18509.34285016381 503427.5960119723,18502.69593728939 503427.5960119723,18482.156661487883 503427.5330080588,18394.554970090045 503427.31249436154,18285.211678208085 503427.0289767508,18082.213068905752 503429.4703783989,17880.427284938516 503431.5337565661,17655.093788299942 503428.4360641523,17583.20632299478 503427.4070002318,16974.257748023374 503419.5945149575,16111.560911423992 503419.27949539,15981.06930591003 503419.0012281054,15885.009339124663 503419.2164914765,15731.558057465358 503419.31099734677,15486.28382220352 503419.18498951977,15334.654403709574 503415.06348351156,15288.740301745245 503413.6878980668,14541.424632072216 503416.7803401544,13686.571782703977 503420.2193037664,13463.648185756756 503419.37400126026,12266.867847489193 503415.0949854683,12079.593964931788 503411.8135316401,10671.981530783465 503404.0955522362,10477.451697521145 503401.24987547635,10000.186552094063 503401.84316232847,9871.506309093209 503402.09517798247,9419.012202324811 503400.6250866675,9065.596999863628 503398.9082300245,8862.619391865795 503391.4685179052,8721.259611272719 503386.1866898233,8693.464384766296 503391.24800420797,8022.876981085865 503389.1898763669,7714.168305580271 503387.9980523365,7645.2945274706 503387.5307733114,7367.3947656673845 503386.3757015638,6882.884170187637 503384.2178175264,6338.561859490583 503382.0021799016,5838.331787592266 503392.18781258434,5818.401549621252 503382.0021799016,5640.793517460115 503376.7518537764,5564.658538319636 503391.9672988871,5199.766122948844 503387.87729483563,4246.453907756135 503378.3427025924,4033.799948709784 503370.5932212317,2644.295889366884 503367.00199816213,2476.3484572761226 503362.6862300872,2449.162268600194 503361.8461779072,1029.4425824072678 503370.81373492896,920.7030780294444 503363.15875943843,-27.185550275957212 503364.8126121679,-539.4913722621277 503370.3412055777,-595.0713246227242 503365.2483892363,-1330.300743555883 503365.7786721749,-1651.7047076320741 503365.8416760884,-1697.0150220920332 503365.8416760884,-1724.8049982723314 503365.87317804515,-1771.3228877410293 503366.2827034829,-2116.8836023190524 503366.37720935314,-2140.447065968532 503366.4087113099,-2154.3394288956188 503366.4087113099,-2524.676432458218 503369.9054285092,-2584.4828973496333 503370.3412055777,-2962.669138469035 503373.4703999483,-3756.49744728487 503380.18556706235,-4151.001702001318 503375.74904148653,-4359.429148516851 503374.1896946274,-4741.238114662701 503371.8743008062,-5008.873488891404 503369.936930466,-5156.885432685027 503368.7818587185,-5295.236776408507 503367.59528501425,-5313.964689696906 503367.626786971,-9390.706417384325 503336.1878341336,-9474.07634592522 503335.87281456613,-9552.610724105034 503335.9673204364,-9625.112477567047 503334.3764716205,-9640.217665828997 503333.9669461828,-9647.468366207788 503333.56267107115,-9654.110028756084 503333.56267107115,-9925.378628663486 503328.4068508162,-10148.906013114844 503328.7166200576,-10146.858385926113 503066.37357456307,-10150.712125301827 502906.59564992297,-10150.192343015457 501989.0329053161,-10138.862139237579 501882.22027062636,-10155.752438382013 501474.9682240782,-10154.634118917398 500980.81277950667,-10153.720562171657 500344.65701455483,-10153.442294887034 500113.2803925462,-10161.029016137822 499018.59264578193,-10158.676870033843 498543.96841439593,-10158.729373295093 498507.49964913074,-10164.320970618166 497116.656756626,-10165.18202410289 496933.9979107325,-10178.360342676984 495308.8434639153,-10177.005758536514 493698.9359641655,-10188.997503406368 492919.25203393074,-10189.060507319868 492876.43562438036,-10198.022814015392 492101.4349850493,-10215.758415666176 491113.68588080164,-10209.389770076377 490483.998517636,-10222.56808865047 488871.2820934092,-10223.633904853836 487266.65642174124,-10222.961863109842 486884.4694321143,-10219.858920369996 485656.5336586202,-10216.425207084045 484659.1239543024,-10226.11730911117 484231.21712477785,-10226.75259857229 484210.4363339745,-10230.002550443634 484054.93742512644,-10230.821601319127 483905.37663512584,-10230.895105884876 483852.0018197377,-10228.700469564646 483691.8458716166,-10228.910482609645 483542.2798312899,-10232.081679589348 483443.1274224168,-10234.00329895108 483369.4075932938,-10233.50451796921 483292.31180447235,-10232.96373437834 483249.09637013637,-10232.417700461345 483205.4399084059,-10232.45445274422 483181.28315790405,-10232.48595470097 483156.31260685297,-10236.292441141559 483037.655236425,-10237.557769737672 482998.6873159242,-10230.585336643504 482788.09148471896,-10241.789532594616 482580.09456494567,-10248.63070753566 482455.5305776268,-10260.953222951386 482310.658328856,-10251.686397340382 482008.1240368736,-10242.272562598111 481384.4692984256,-10245.259998163441 480987.0301114052,-10244.866223703837 480838.34612586757,-10246.115801321808 479958.37571631663,-10246.073798712809 479558.405872104,-10246.367816975806 479353.77966170304,-10238.067051371792 479223.28280586284,-10238.093303002417 479202.93779212784,-10233.793285906082 478817.00206964766,-10237.972545501543 478006.939752453,-10236.733468536055 477596.0019769649,-10242.676837709732 475970.87378177827,-10266.177297445945 474368.6895117584,-10267.84690115368 473622.6864236165,-10275.916652407963 473490.5304647208,-10282.395554846385 472777.12665148976,-10284.458933013491 472605.15746958717,-10285.22023030161 472496.7172337986,-10292.12965948251 471903.65614568186,-10288.953212176682 471580.40406680957,-10287.955650212942 471428.3441215735,-10285.881771393586 471180.0929513988,-10281.597505275393 470776.8101514011,-10281.156477880897 470661.5917445851,-10279.051097104792 469579.2475145409,-10272.671950862743 468944.68784873106,-10274.478063049726 468527.8749583089,-10277.055973177077 467994.9668566078,-10277.701763290446 467967.029871296,-10293.84651612537 467289.7167998492,-10313.398730615387 466350.21819269157,-10316.863945857855 464773.6555141624))

func TestDifficultLine2(t *testing.T) {
	//	line := geom.T(geom.MultiLineString{[]geom.LineString{
	//		{[]geom.Point{{1990.0286865234375, 479215.03125},
	//			{1943.354248046875, 479215.03125}}},
	//		{[]geom.Point{{1943.354248046875, 479215.03125},
	//			{888.0219116210938, 479254.625}}},
	//		{[]geom.Point{}}, {[]geom.Point{}}, {[]geom.Point{}}}})
	line := geom.T(geom.MultiLineString{
		{{1990.0286865234375, 479215.03125},
			{1943.354248046875, 479215.03125},
			{888.0219116210938, 479254.625}},
		{{0, 0}, {0, 0}, {0, 0}}})

	shape := geom.T(geom.Polygon{
		{{0, 468000}, {36000, 468000}, {36000, 504000}, {0, 504000},
			{0, 468000}}})

	drawLine(line, shape, nil, "difficultLine2.png")
	intersection := Construct(line, shape, INTERSECTION)
	drawLine(line, shape, intersection, "difficultLine2.png")
}

//cell POLYGON((0 468000,36000 468000,36000 504000,0 504000,0 468000))
//srg MULTILINESTRING())

func TestDifficultLine3(t *testing.T) {
	line := geom.T(geom.MultiLineString{
		{{-196677.5625, 178048.875}, {-196642.265625, 178069.5}}})

	shape := geom.T(geom.Polygon{
		{{-202425.1102908093, 118464.62245425}, {-201771.43943790416, 118448.89247717895}, {-201378.07975428295, 118439.6939058078}, {-201021.6403639738, 118431.07812063652}, {-200991.7975102784, 118427.75991452532}, {-200926.27869056282, 118424.3262012396}, {-200903.39251898346, 118422.87711122888}, {-200427.8284792211, 118415.35864421772}, {-200104.42414089106, 118410.19757363689}, {-199924.8892390423, 118407.57241057418}, {-199741.5320997741, 118404.84224098921}, {-199334.73683159868, 118398.35808822466}, {-199003.17348647048, 118388.38246858679}, {-198825.60745691834, 118383.30540322396}, {-198708.51468367572, 118379.81393635063}, {-198525.87683908665, 118374.18033641833}, {-198202.46725043072, 118368.67274431302}, {-197960.26445595222, 118375.86044077831}, {-197211.98272627196, 118349.17828341038}, {-197191.4539511227, 118354.97464345256}, {-196616.6849992259, 118341.73332096497}, {-195355.25214505335, 118308.28349322174}, {-195184.0495107649, 118303.87321927678}, {-194679.75043611974, 118298.92741206684}, {-194544.2657704607, 118292.49051223742}, {-194531.53372960724, 118292.16499201767}, {-194457.75089657074, 118288.58426960022}, {-194445.60689224326, 118290.38513146131}, {-194245.7322269855, 118286.10086534312}, {-193764.51358598634, 118275.47420526575}, {-193517.58024766902, 118269.17381391558}, {-193139.5147640505, 118259.52896482381}, {-192935.20357321692, 118254.32589163375}, {-192919.73611245234, 118261.53983972967}, {-192596.96706358367, 118256.70428936859}, {-192560.67155908048, 118256.21075871284}, {-192234.0802727926, 118251.71647954965}, {-192169.15473992936, 118250.06787714642}, {-191577.90501432563, 118233.84436941962}, {-190700.96929327515, 118207.50873357593}, {-190466.67348994105, 118204.15377518209}, {-189939.14172219206, 118187.11646690592}, {-189765.42418168974, 118181.078591862}, {-189412.1874903168, 118172.24229299347}, {-189094.5795120292, 118164.31955087068}, {-188918.29456205154, 118159.49975148775}, {-188197.17276941682, 118141.1393610281}, {-188179.35841287416, 118140.70358395972}, {-187773.95448112185, 118129.3838808341}, {-187390.1241394179, 118121.14611914358}, {-187104.3751400574, 118113.24962865142}, {-186958.61033584527, 118109.65840558195}, {-186591.39202600112, 118099.34151474596}, {-185801.96874080435, 118087.97455868497}, {-184982.1093150603, 118070.8847471478}, {-184210.62639423297, 118055.05501388037}, {-184197.6423377255, 118353.67256257357}, {-184190.23412756296, 118527.02258024714}, {-184148.68829693482, 119476.86958019738}, {-184155.84449144336, 119496.88907371252}, {-184147.95325127733, 119507.24796715751}, {-184142.28289906215, 119636.31148396549}, {-184110.90695013828, 120534.47427353985}, {-184100.64256256376, 120747.03372671595}, {-184090.8612049925, 120992.95375209115}, {-184080.96959057287, 121242.6697632547}, {-184054.5919521202, 122564.04034047178}, {-184040.51582777873, 122829.71209272975}, {-184044.73183965706, 122865.28305222746}, {-184022.2026902542, 123400.12327394262}, {-184001.62666216982, 123906.73249208299}, {-183963.12602069415, 124836.82776515046}, {-183960.32759686955, 124899.25939310435}, {-183952.20534235402, 125233.88892868976}, {-183933.46692841337, 126005.71837104135}, {-183902.31149318675, 126685.61460294155}, {-183863.34357268596, 127662.16476156423}, {-183857.78347731964, 127812.35034037381}, {-183815.14032853115, 128887.20235503744}, {-183774.2822906254, 129915.65723773302}, {-183755.01359374612, 130473.40463233227}, {-183730.88834520127, 130708.01545523386}, {-183715.84616085258, 130855.86463891761}, {-183680.23319874587, 132035.2033937974}, {-183676.04868882406, 132128.84296023916}, {-183673.5757852192, 132204.78367731324}, {-183668.6562296399, 132302.62350465497}, {-183668.38846300752, 132313.18716081884}, {-183671.32864563772, 132716.09193733544}, {-183664.81299091643, 132748.85922268243}, {-183658.8591210905, 132784.60869326838}, {-183658.74886424188, 132841.61148400907}, {-183661.26377045573, 132921.06466926076}, {-183649.74980526324, 133107.4197447463}, {-183647.8439368799, 133185.92262096913}, {-183644.6884908788, 133290.14159455313}, {-183618.83063471247, 134433.84113569558}, {-183608.36148441886, 134891.31255163066}, {-183607.6579407181, 134946.60898638074}, {-183607.37442310737, 134958.43797114072}, {-183607.73669561, 134969.84167948435}, {-183608.46649094136, 134991.38901790185}, {-183609.31179344747, 135009.15612150938}, {-183610.1570959536, 135026.90747413854}, {-183611.7951977048, 135037.92265834892}, {-183596.46949574538, 135302.7333571224}, {-183593.70257387753, 135311.95292979805}, {-183590.96715396643, 135320.3271999678}, {-183577.51581843384, 135664.5805833405}, {-183516.79579679668, 137250.83011357044}, {-183473.15508604445, 138394.54540569126}, {-183456.3750437484, 138824.43685849127}, {-183409.06435503485, 140067.73508622753}, {-183391.34450436267, 140509.84404792055}, {-183377.7514100247, 140913.2213537884}, {-183377.54664730583, 140921.65862787142}, {-183335.40752982534, 142056.9996498227}, {-183333.02913209074, 142181.09635811648}, {-183328.90762608242, 142429.29502502992}, {-183287.79757252266, 143391.091767241}, {-183277.04490461852, 143651.39243587293}, {-183269.65769576048, 143747.06387852505}, {-183257.0464124079, 143848.11165512935}, {-183253.15592074906, 143877.57648534374}, {-183240.79665305046, 144256.48202114226}, {-183225.78072033264, 144691.92306865635}, {-183222.2209992197, 144865.40434448305}, {-183224.48388977977, 144876.43527967203}, {-183233.35694093117, 144929.01729581528}, {-183228.98341926886, 145004.92126060626}, {-183207.4045788946, 145057.608283272}, {-183208.59115259885, 145113.3772473731}, {-183218.25175266922, 145133.87452056562}, {-183224.87241391302, 145174.58029901376}, {-183212.93842263054, 145247.76459487202}, {-183211.45258033718, 145649.33053822676}, {-183207.68809650536, 146851.09343598713}, {-183203.75035191164, 147641.11000803602}, {-183174.20151647925, 148466.40877164598}, {-183130.89157627313, 149755.06456677732}, {-183094.34405611595, 150713.21758265747}, {-183081.4702564571, 151217.98393632774}, {-183070.98535518534, 151519.2634003663}, {-183071.23212051322, 151534.88837091485}, {-183073.84153259732, 151662.90707282396}, {-183060.45320097823, 151796.87439423287}, {-183030.09581532283, 152839.2478914864}, {-183022.8136129873, 153087.38880481245}, {-183018.74986056634, 153228.7643363839}, {-183017.81005218998, 153267.17047198932}, {-182988.04595338646, 154337.85897803563}, {-182982.89013313176, 154498.2196888756}, {-182982.5173599769, 154513.40363202943}, {-182966.15734377084, 154979.24931813427}, {-182962.28260309063, 155086.42422532663}, {-182945.2505451406, 155553.5142387231}, {-182926.7956488107, 156053.5132962719}, {-182912.01598076848, 156453.9399188573}, {-183291.46755048423, 156457.657149754}, {-183415.24923921027, 156474.16942541744}, {-183434.25016945717, 156475.0619808589}, {-183538.62665282493, 156482.2496773242}, {-183671.65416585747, 156482.95322102495}, {-183665.93656070717, 156536.02876782394}, {-183664.92324776505, 156551.62748674164}, {-183626.1075867219, 158067.6696560264}, {-183587.37593089673, 159580.34111593873}, {-183585.18654490262, 159669.82767441543}, {-183582.1571067283, 159794.3444087992}, {-183580.1567324747, 159850.4546440984}, {-183578.8126489867, 159906.1711049385}, {-183562.93566278415, 160480.15775824268}, {-183544.02923840773, 161282.54934896855}, {-183527.6272195927, 161930.43959281011}, {-183502.96643778286, 162891.07601294736}, {-183501.51734777237, 162950.5937099019}, {-183505.4708433447, 162970.10917210905}, {-183489.09507616027, 163357.00045394409}, {-183460.10802562349, 164053.15694585396}, {-183464.26628391468, 164064.23513397807}, {-183463.68874804094, 164087.87735251943}, {-183460.50180008286, 164244.90410627006}, {-183440.45080461097, 165146.5478620655}, {-183437.90439644037, 165276.99746497045}, {-183426.82620831626, 165758.20560531737}, {-183422.14291741257, 165976.43541070865}, {-183420.42081044358, 166046.92103893845}, {-183419.5807582636, 166081.96696582367}, {-183416.60907367687, 166203.5330169252}, {-183416.9713461795, 166214.93672526884}, {-183409.18511253572, 166560.6549496306}, {-183402.53294933517, 166834.1706891195}, {-183401.7821526993, 166864.564827058}, {-183395.92278874363, 166897.35836403538}, {-183401.56163900206, 167003.9399843756}, {-183382.26669049216, 167692.31024264195}, {-183375.294257398, 168186.29767677747}, {-183382.74972049566, 168269.6886066231}, {-183383.04898908501, 168387.53217650158}, {-183322.01394788013, 170868.23251573555}, {-183278.75126060913, 172618.7332484643}, {-183233.8452212608, 174177.43956784182}, {-183232.2018691837, 174218.79638672946}, {-183201.54521493893, 175192.46936663566}, {-183186.06200319598, 175672.74819925847}, {-183161.24896192853, 176458.18648692616}, {-183168.56266622082, 176469.34342994215}, {-183147.20433954382, 177242.62721263035}, {-183116.64219116955, 178342.6072881287}, {-183110.67257036525, 178561.68764635222}, {-183108.4359314358, 178860.67271787417}, {-183091.43537544273, 179610.8445649594}, {-183090.73183174198, 179639.96812397544}, {-183074.37706586206, 180389.73569594906}, {-183072.87547259033, 180450.93874758994}, {-183071.06411007722, 180499.4675119645}, {-183018.60810176097, 181901.79811803112}, {-183016.25070533087, 181972.7037723509}, {-183020.82898971182, 182018.01408681087}, {-183017.7943012116, 182065.2512709587}, {-183008.1704534241, 182486.13841445395}, {-182999.02963564033, 182887.6256029168}, {-182982.34409921477, 183650.90751433652}, {-182955.57793662883, 184724.0006697483}, {-182942.8773977321, 185245.78333039023}, {-182942.48362327274, 185261.82832702855}, {-182940.65650978102, 185336.9709945314}, {-182931.7362056945, 185859.2681871336}, {-182914.1266118707, 186816.0141156125}, {-182914.11086089234, 186842.62276841444}, {-182887.87498124503, 187478.967545107}, {-182878.18812954426, 187721.6271179584}, {-182851.95224989695, 188462.32737671398}, {-182848.3452758491, 188714.00175952213}, {-182830.0793912597, 190060.2168799634}, {-182816.54930083524, 190668.1731432972}, {-182802.73569280002, 191623.77975100675}, {-182798.73494429258, 191632.96782172564}, {-182749.28212252003, 193197.70151549485}, {-182734.78072176245, 193974.60802320926}, {-182727.9395468214, 194255.79448916693}, {-182724.16981266346, 194410.3115870296}, {-182722.01717895223, 194421.23226536997}, {-182712.4510847521, 194658.40524742054}, {-182704.95361904544, 194811.57826179522}, {-182767.87352732895, 194816.48206639616}, {-183515.3099545031, 194851.20247306162}, {-183999.9833100927, 194881.6543645875}, {-184311.1543885509, 194892.2495227079}, {-185113.14170416514, 194939.02992848284}, {-185438.60942066228, 194957.6265836181}, {-185565.7670690869, 194964.9822905194}, {-185638.78335450916, 194969.7495866411}, {-185871.06303261127, 194983.53169271955}, {-186675.25023487187, 195017.42254785728}, {-187301.5616383392, 195030.07583381888}, {-187457.82709480147, 195033.56205036608}, {-187535.95194754354, 195035.09514559456}, {-187895.7357955943, 195042.39309890848}, {-188244.81422867626, 195049.45478754677}, {-188574.10943291849, 195040.82850172324}, {-188621.40437065368, 195039.90444432502}, {-188693.8431202022, 195042.14108325448}, {-189265.89240316604, 195057.3880303218}, {-189856.79560724553, 195074.01581316022}, {-190643.67248427146, 195094.37657787348}, {-190776.61074175988, 195097.76303822407}, {-191287.25221036444, 195097.65803170158}, {-191352.60826996993, 195105.67002936848}, {-191436.18821155606, 195116.66946260072}, {-192212.39117556973, 195135.25036675762}, {-192666.50238278485, 195151.53162807156}, {-193014.81426825235, 195163.8593938134}, {-193035.61081003398, 195163.9854016404}, {-193534.78031605505, 195169.2357277656}, {-193585.82923696958, 195169.70300679072}, {-193802.0009145199, 195172.3281698532}, {-194045.16976900538, 195179.032836315}, {-194623.49844201514, 195194.8573192563}, {-196022.84161251644, 195227.0470687293}, {-196193.0624358193, 195250.93605259876}, {-196259.76782923914, 195256.06037089694}, {-196317.11189117795, 195256.71666166256}, {-196370.04567917157, 195257.6722210173}, {-196465.20258986345, 195259.3103227683}, {-196550.2631234168, 195260.70165919163}, {-196666.85711567756, 195262.48677007412}, {-196789.73574831034, 195264.4398913926}, {-196993.26464055106, 195268.0941183758}, {-197606.45547903166, 195276.6101473507}, {-197861.70533393114, 195279.9546050923}, {-198203.96884370246, 195281.81322054076}, {-198611.7984261245, 195284.56439143023}, {-198651.46989032603, 195286.0292324191}, {-199464.57739667338, 195316.06109785498}, {-199509.31017525936, 195317.24767155922}, {-199915.12363244942, 195324.25160661014}, {-200295.49925956316, 195339.87657715846}, {-200349.82963430602, 195335.8443266945}, {-201061.10706545622, 195354.01570541342}, {-201258.923602873, 195359.73331056372}, {-201767.28117961297, 195374.65473741153}, {-201898.37657263153, 195376.0775757914}, {-202300.49905055552, 195380.1413282121}, {-202548.18843583483, 195382.5932305127}, {-202669.78073856677, 195385.89043531916}, {-203265.33048126684, 195394.39071331592}, {-203524.2345631495, 195402.2504515252}, {-204256.7810654326, 195426.79572616005}, {-204389.86108172638, 195424.93711071182}, {-204765.34340489144, 195434.74997023982}, {-205049.4700534793, 195442.49945160048}, {-205307.7650975315, 195449.14111414878}, {-205550.33016451262, 195455.35750028095}, {-206380.15470924228, 195472.64157388476}, {-206517.0464623028, 195470.07941473578}, {-206628.65789507097, 195469.3443690783}, {-206636.42312741, 195461.95190989412}, {-207318.70300737116, 195480.35955328867}, {-208147.7820057911, 195502.4529256234}, {-208295.84120252007, 195506.1386545631}, {-208690.2352003879, 195516.2665336586}, {-208897.51807580818, 195521.61136565404}, {-209171.57984921406, 195528.38953668159}, {-209890.63826368167, 195538.74843012635}, {-210508.93766948208, 195545.93612659164}, {-210533.86096759792, 195556.76754938788}, {-210667.26650411147, 195565.59334760415}, {-211277.8741821386, 195576.8447964904}, {-212455.61158755026, 195599.111429587}, {-213383.31271190452, 195611.90647435398}, {-214497.76793653006, 195620.45400528563}, {-214652.03301873873, 195627.38968609693}, {-214681.79711754224, 195622.74839780247}, {-215301.10983628454, 195638.38911932916}, {-215473.73530895286, 195642.92015077523}, {-215488.09495090507, 195647.9867154858}, {-215524.20144366776, 195641.82808294124}, {-215884.59432954923, 195650.9216477899}, {-216096.8597644621, 195657.87307957956}, {-216841.5922736819, 195675.56142829522}, {-218374.87651396147, 195743.2643836788}, {-219249.32883075485, 195766.65458656615}, {-219759.60802685656, 195780.73596123373}, {-221894.10711172526, 195836.37366718194}, {-221914.26311371964, 195836.96695403405}, {-222016.96999337967, 195839.57636611816}, {-222436.32929197233, 195858.34628201555}, {-223022.54920514813, 195884.6084132935}, {-223295.812928983, 195896.9676809921}, {-223576.1383414562, 195905.31044920487}, {-224173.3419368856, 195922.70477965754}, {-224546.2673512278, 195933.8617226733}, {-224752.88868555636, 195940.04660684871}, {-225348.1391596673, 195959.15779394424}, {-225513.45092804334, 195955.25155130704}, {-225605.5784005609, 195952.9519084643}, {-225690.124402154, 195951.2665537782}, {-225745.59409766598, 195951.67082888982}, {-225912.63847366325, 195952.9046555292}, {-226398.64016176248, 195957.4041850185}, {-227161.7173104633, 196014.68524304358}, {-227264.59220055933, 196011.466793129}, {-228095.56131638424, 196033.7334262256}, {-228206.99948839028, 196039.2357680048}, {-228333.03356702393, 196041.79792715376}, {-228380.24974986725, 196043.65654260223}, {-228423.71719985735, 196044.98487511184}, {-228440.73350682878, 196045.4994070721}, {-228752.07784604933, 196049.90443069115}, {-228822.01744036213, 196051.20126124402}, {-229056.43925152346, 196055.81104758172}, {-229306.54903714638, 196062.61021991377}, {-231349.71869906853, 196115.1869857309}, {-231681.1087834346, 196123.7187656844}, {-231987.71732849022, 196118.40543564572}, {-232088.01430845866, 196116.86183976498}, {-232608.8729117026, 196135.95202555577}, {-233283.314054759, 196163.6579965183}, {-233577.59483407275, 196169.4228546035}, {-233844.76817960246, 196175.2034636673}, {-234575.3930625238, 196200.96681396337}, {-234793.42335552233, 196204.84155464382}, {-235446.9524496221, 196216.01424863795}, {-236099.72024643398, 196231.030181356}, {-236878.501120575, 196249.24881301005}, {-237274.90599334892, 196255.4389475116}, {-237485.1553030298, 196266.73239900684}, {-237699.9828970919, 196272.68626883277}, {-237762.35677145864, 196274.250866018}, {-238061.60960961273, 196282.46762640378}, {-239923.5642653259, 196324.02920801053}, {-240849.82680032193, 196344.82574979216}, {-240957.99926947826, 196353.3732807238}, {-241912.17253815546, 196388.29845010815}, {-243012.2943724594, 196414.1405552961}, {-243290.17313295812, 196420.60895708227}, {-243409.32928436808, 196421.51726350188}, {-243942.856924552, 196438.42331362492}, {-243970.53139355755, 196440.57594733615}, {-244614.24762812955, 196462.81107847602}, {-244703.125148776, 196464.01340315863}, {-247150.34415830998, 196503.6743667079}, {-247808.31502831168, 196514.3902823294}, {-247941.26378645236, 196460.4694330243}, {-247976.40421920782, 196446.41956031346}, {-248135.81462101918, 196488.4536712712}, {-252217.48640493816, 196644.404108166}, {-253878.20131060085, 196708.4528365666}, {-254317.77961510164, 196725.8734186499}, {-256481.0294858315, 196810.07814904465}, {-256733.60692473338, 196818.7201858468}, {-258128.67107944284, 196869.5328420857}, {-258200.4535382255, 196872.43627243303}, {-258560.62591040973, 196888.2187527651}, {-260158.91968877078, 196951.92095964123}, {-262692.0602853426, 197043.9854282455}, {-263817.5306941788, 197085.17423669714}, {-268055.43643260305, 197314.84450271516}, {-268445.84543294203, 197295.42354637827}, {-268512.78184071137, 197293.15540549206}, {-268960.5296526628, 187588.11132459622}, {-269098.25095725106, 184606.0783449777}, {-269099.46903291205, 184590.48487638612}, {-269118.5014651157, 184340.6113554386}, {-269136.6570928565, 183798.29466932127}, {-269239.53198295226, 180784.67047740775}, {-269276.24751354544, 179706.01722662966}, {-269328.9975401247, 178162.31108899158}, {-269439.74791940814, 174911.2198967645}, {-269488.7492131342, 173471.79573662393}, {-269585.8119922094, 170778.43618801748}, {-269738.0609491861, 166067.1715468031}, {-269734.8424992715, 166015.51358805806}, {-269724.7513724589, 165748.98603264173}, {-269727.4710413916, 165619.8122589849}, {-269729.8441888003, 165535.812291309}, {-269745.72117500263, 164827.45404148428}, {-269746.9077487069, 164546.54584281123}, {-269746.5297252259, 164521.1867676268}, {-269760.0335640197, 164427.87272140477}, {-269760.68985478533, 164409.31281855237}, {-269786.8102272579, 163484.59387943707}, {-269792.4385768641, 163274.40757366968}, {-269799.3742576754, 163027.500486983}, {-269800.6238352931, 162975.15473551536}, {-269813.7811525627, 162235.87731513963}, {-269816.7790887803, 162046.29853941337}, {-269817.1571122613, 162035.75063422788}, {-269823.9352832888, 161987.8256573577}, {-269830.68720268575, 160913.7191890038}, {-269847.06296986993, 160810.3770198829}, {-269874.06014680536, 159861.64308907115}, {-269867.4709875183, 159762.1231573692}, {-269881.96713795, 159357.48577323137}, {-269877.3416006337, 159344.65397618152}, {-269879.68849641155, 159243.76370936097}, {-269877.6566202012, 159105.54887411674}, {-269875.6562459476, 158966.90876245638}, {-269817.40387758915, 158964.8296333109}, {-269735.65629982087, 158964.43585885153}, {-269425.7190480018, 158946.16997426213}, {-269224.3427894723, 158941.09290889907}, {-269035.0002784217, 158936.43586962624}, {-268630.1896335215, 158930.03047175356}, {-268655.53295772756, 158450.17166522075}, {-268728.47048825794, 157310.43612030288}, {-268741.65405715816, 156904.50190561195}, {-268753.53029485326, 156535.7032476042}, {-268774.34258761327, 155204.01577955135}, {-268780.3437103743, 154928.79893439775}, {-268793.0337486188, 154323.0320570583}, {-268804.90473598754, 153758.64299991075}, {-268808.5957152536, 153583.87539418344}, {-268845.18523801956, 152609.75088623073}, {-268894.02902196185, 151648.73644261225}, {-268928.78093058406, 151011.6566202622}, {-268907.4068529287, 150400.46615603543}, {-268892.3751692325, 149521.6875705151}, {-268889.28272714466, 149340.7665825691}, {-268880.59343740763, 149299.9085446631}, {-268888.6579383358, 148895.50217487477}, {-268890.0335237805, 148838.51513511245}, {-268914.00126254186, 147702.59132696153}, {-268924.1868952245, 147041.85878541786}, {-268952.28139032004, 146163.3584671819}, {-268952.8116732589, 146148.59455011808}, {-268974.5322724385, 145538.95293209818}, {-269012.37662314833, 144529.43597573577}, {-269013.8099621807, 144488.9349600065}, {-269019.1232922191, 144393.65729181375}, {-269085.8129346606, 143251.68510796642}, {-269096.5603522388, 143075.07988809515}, {-269103.31227163575, 142957.0315554978}, {-269136.594088943, 142289.53134357883}, {-269185.6268846255, 141323.51333916327}, {-269253.9073758831, 139959.0165831542}, {-269264.7177973746, 139745.233803991}, {-269269.810613716, 139655.0332011613}, {-269307.7494702963, 138893.9196744312}, {-269353.9050872624, 137990.3437986218}, {-269392.7837522188, 137220.40447367541}, {-269511.5618801478, 134903.1100344339}, {-269507.2198604422, 134882.68626580713}, {-269502.93559432426, 134859.7213393359}, {-269517.5315009521, 134807.01331536565}, {-269578.90781335486, 134138.01676050108}, {-269634.81328593544, 133604.40511509916}, {-269654.2184912937, 133416.2806797095}, {-269655.24755521445, 133387.17287167185}, {-269687.3427988172, 132540.56303432002}, {-269715.6263056535, 131782.5314490255}, {-269726.21621344774, 131502.85707699182}, {-269753.0296289688, 130787.0171124388}, {-269776.908112186, 130134.85310313129}, {-269772.71835193806, 129930.69417175557}, {-269805.5958941337, 129294.05537680001}, {-269807.4702605603, 129259.0724538283}, {-269841.65513396123, 128585.73387925816}, {-269841.97015352873, 128577.29660517513}, {-269885.2485917781, 127737.87446428882}, {-269961.6880898338, 125790.0402241468}, {-269970.7186507692, 125571.568903754}, {-270008.184977998, 124609.88241839153}, {-270097.43527179933, 122445.86600004719}, {-270104.1556892395, 122257.72581367916}, {-270136.8442196946, 121394.30443207477}, {-270167.00209295726, 120583.5858241145}, {-269410.9393799596, 120561.31919101765}, {-269006.21799060376, 120549.0544291893}, {-268587.4362278846, 120536.73191377381}, {-268276.7796813864, 120530.79904525238}, {-267467.34215300065, 120504.30589962495}, {-267419.62718917546, 120502.61529461248}, {-267233.0936026017, 120498.99781991239}, {-267226.1894237471, 120496.64042348228}, {-267216.0930466086, 120493.3274676972}, {-267138.09420169354, 120482.9790749047}, {-266981.314213271, 120485.05295372405}, {-266613.8123858161, 120464.51367792254}, {-266387.2503128643, 120457.38898537075}, {-266019.43871616805, 120445.74376202514}, {-265819.6270548238, 120439.57987915422}, {-265590.47132076626, 120434.07753737504}, {-265396.4350181597, 120426.858338953}, {-264891.09112861543, 120412.55645058816}, {-264672.1577795234, 120406.17205401999}, {-264564.62585015455, 120402.84334725677}, {-264224.1264499612, 120393.49776675389}, {-263674.343800094, 120375.19512988161}, {-262996.6579554924, 120352.91274580662}, {-262694.31267525046, 120344.96900237934}, {-262596.3100877986, 120342.41209355649}, {-261834.4510147588, 120322.39260004135}, {-261483.7502309042, 120313.2412816051}, {-261000.01668369118, 120300.78750803624}, {-260940.84550826089, 120298.75038149976}, {-260762.6546899001, 120293.46855341783}, {-260660.45184154809, 120301.34929293161}, {-260622.4867333374, 120312.7162489926}, {-259496.375784714, 120269.8525865071}, {-259423.85828027362, 120266.9544064859}, {-259318.24797026673, 120262.91165536968}, {-259037.06150430907, 120251.6077032222}, {-258538.92106220848, 120232.0607390583}, {-258019.15452679852, 120211.82073184592}, {-257895.75086155348, 120206.7751684396}, {-257439.59202714963, 120188.73504787381}, {-256822.50019635796, 120164.42078758823}, {-256361.15403974243, 120149.22634378215}, {-256104.09282232984, 120140.53180371877}, {-255834.37306862953, 120129.31185678951}, {-255182.31406584452, 120102.68745300896}, {-255007.98223718558, 120095.96703556878}, {-254771.15577665926, 120072.80259670457}, {-254764.9866434622, 120067.11124318489}, {-254444.716749829, 120062.25994184543}, {-253342.1430132247, 120039.68878983334}, {-253081.87384654954, 120031.41427586018}, {-253072.24999876204, 120033.20463706879}, {-252636.04765395983, 120028.7891127977}, {-252577.5012673384, 120026.83599147899}, {-252535.22039105278, 120014.86524791387}, {-252507.6246769391, 120001.70268031815}, {-252366.17039047577, 120021.90593524766}, {-251633.74989601946, 119978.9740185223}, {-251147.34393280884, 120008.87462580507}, {-250977.26486831112, 120008.7328669997}, {-250334.54619570286, 120008.17108210432}, {-250140.68840418453, 119995.01376483473}, {-249905.9673244343, 119984.73362628161}, {-248533.9678523927, 119922.73252506997}, {-248329.7984203645, 119913.50770206796}, {-247338.15882445825, 119868.83792739548}, {-247139.07695844537, 119859.80211613397}, {-246625.7630738432, 119836.74793411861}, {-246571.05992594548, 119834.1227710559}, {-245637.40493176505, 119808.45917695644}, {-245399.3761465561, 119802.0170268009}, {-245195.72124648816, 119796.68794578384}, {-245039.78131024563, 119792.49293520977}, {-243973.59233368863, 119748.38494543266}, {-243370.20385408355, 119733.21150293085}, {-243069.13965341612, 119726.08681037906}, {-242985.7644745491, 119723.83442047145}, {-242389.35892869066, 119709.380272649}, {-242081.9208321073, 119702.09281998733}, {-242027.20193323097, 119700.34446138749}, {-241722.9507846057, 119693.17251590057}, {-241534.59533486655, 119687.16614281363}, {-241460.15621106443, 119684.3677189888}, {-241381.8738485386, 119681.87381407944}, {-240694.00237125414, 119659.57567902585}, {-240442.0182192044, 119651.16465657344}, {-239910.04467555368, 119633.88058296964}, {-239593.96979249455, 119597.7005856412}, {-237909.52866307227, 119524.79455706757}, {-237863.71956763044, 119522.93594161933}, {-237219.3260409881, 119495.14071511291}, {-236752.8765673791, 119480.55530913733}, {-236252.88801048254, 119458.62469691248}, {-236153.01630693022, 119454.24067459814}, {-235551.50219375198, 119440.59507699893}, {-235169.57772043138, 119431.69577421667}, {-234380.43795284536, 119408.93561046431}, {-233810.84582250798, 119392.61759686726}, {-233142.67356884503, 119371.61104204063}, {-231955.68508880073, 119339.84131865762}, {-231941.60896445927, 119342.36672552372}, {-231187.51512375847, 119318.90826839651}, {-230943.77923405147, 119311.47905692947}, {-230920.8773114935, 119310.78076355485}, {-230362.0798516695, 119295.47081257403}, {-229601.98488820763, 119239.04555770708}, {-229485.5011527955, 119236.35739073111}, {-229467.31402309798, 119248.06036766409}, {-227743.3746902363, 119195.22633586684}, {-227667.59148294618, 119194.21302292473}, {-227246.24756107805, 119183.68086871761}, {-226341.81063178414, 119160.84195007337}, {-226266.93573091342, 119151.42811533087}, {-226252.96986342059, 119149.74801097088}, {-225627.95529050636, 119133.65051107132}, {-225528.0310836928, 119131.10410290048}, {-224978.4689475228, 119105.4772610839}, {-224809.20368357445, 119099.61789712822}, {-224782.48477392364, 119098.81984755723}, {-224645.671775755, 119094.34131937241}, {-224495.4389440103, 119091.15437141433}, {-224406.95519782347, 119089.38501151023}, {-224305.73416045704, 119087.65765421512}, {-224040.81320483494, 119064.6192231779}, {-224002.5645790135, 119065.6010341635}, {-223955.3903987792, 119066.74035493261}, {-223947.18938937155, 119063.96293241228}, {-223914.79487717967, 119060.89674195531}, {-223868.3452419506, 119059.52115651057}, {-223787.53222223255, 119056.71223203349}, {-223773.5296024566, 119056.30270659574}, {-223695.8930300444, 119054.00831407914}, {-223375.1401064077, 119044.55247672764}, {-223367.57963678753, 119041.79605551204}, {-223077.1578471756, 119040.84574648342}, {-222740.93746277434, 119038.13132787659}, {-222671.53340172628, 119037.35952993622}, {-222612.93976216973, 119036.90800188947}, {-222413.79489224334, 119029.37378389994}, {-221664.95137766772, 119000.68075162615}, {-220941.54569316842, 118973.22679631785}, {-220813.65824941243, 118968.65376226278}, {-220642.68662947346, 118956.07923119306}, {-219315.8452124342, 118936.99954605429}, {-219058.8732505655, 118924.49851955031}, {-218134.24881732045, 118895.30670629465}, {-217656.34313210635, 118880.3065245552}, {-217102.70149253705, 118863.15370910428}, {-216629.23233289854, 118848.35303975758}, {-215693.12543641776, 118819.54450030904}, {-215176.4040901605, 118803.17398345075}, {-214541.29839043366, 118783.90528657148}, {-213336.00202319096, 118746.50721358228}, {-213044.53016835428, 118737.891428411}, {-212822.4518739134, 118730.80348814186}, {-212681.79563702107, 118726.86049322202}, {-212056.87556997687, 118707.6653009085}, {-211905.41941224504, 118703.00826163543}, {-211829.68870821618, 118700.89238020708}, {-210353.90603965893, 118655.99159118487}, {-210075.17147600185, 118647.42305894871}, {-209993.0773767091, 118645.14966773661}, {-208879.38869969803, 118611.84159879875}, {-208631.83057257184, 118604.61189972446}, {-207660.4204832255, 118585.10693816957}, {-207194.45403962, 118575.74035636219}, {-207156.2631673857, 118574.69554146333}, {-205614.000869432, 118539.04582707374}, {-205371.483055386, 118533.73249703506}, {-204713.29692201316, 118520.15515367547}, {-203161.53153377306, 118482.21104676905}, {-202425.1102908093, 118464.62245425}}})

	drawLine(line, shape, nil, "difficultLine3.png")
	intersection := Construct(line, shape, INTERSECTION)
	drawLine(line, shape, intersection, "difficultLine3.png")
	drawLine(line, nil, intersection, "difficultLine3.png")
}

func TestDifficultLine4(t *testing.T) {
	line := geom.T(geom.MultiLineString{
		{{1.996889625e+06, 443289.9375}, {1.99685025e+06, 443318.53125}, {1.99685025e+06, 443318.53125}, {1.996842875e+06, 443323.9375}, {1.99685025e+06, 443318.53125}, {1.996842875e+06, 443323.9375}, {1.996842875e+06, 443323.9375}, {1.9968197232187183e+06, 443337.1989592995}, {1.9967845e+06, 443357.375}, {1.9967391211110454e+06, 443391.6950416795}, {1.99669025e+06, 443428.65625}, {1.996620125e+06, 443478.5625}, {1.99650475e+06, 443550.15625}, {1.996620125e+06, 443478.5625}, {1.99669025e+06, 443428.65625}, {1.9967391211110454e+06, 443391.6950416795}, {1.9967845e+06, 443357.375}, {1.9968197232187183e+06, 443337.1989592995}, {1.996842875e+06, 443323.9375}, {1.996842875e+06, 443323.9375}, {1.99685025e+06, 443318.53125}, {1.996842875e+06, 443323.9375}, {1.99685025e+06, 443318.53125}, {1.996842875e+06, 443323.9375}, {1.99685025e+06, 443318.53125}, {1.996842875e+06, 443323.9375}, {1.996842875e+06, 443323.9375}, {1.9968197232187183e+06, 443337.1989592995}, {1.9967845e+06, 443357.375}, {1.9967391211110454e+06, 443391.6950416795}, {1.99669025e+06, 443428.65625}, {1.996620125e+06, 443478.5625}, {1.99650475e+06, 443550.15625}, {1.996620125e+06, 443478.5625}, {1.99669025e+06, 443428.65625}, {1.9967391211110454e+06, 443391.6950416795}, {1.9967845e+06, 443357.375}, {1.9968197232187183e+06, 443337.1989592995}, {1.996842875e+06, 443323.9375}, {1.996842875e+06, 443323.9375}, {1.99685025e+06, 443318.53125}, {1.996842875e+06, 443323.9375}, {1.99685025e+06, 443318.53125}, {1.996842875e+06, 443323.9375}, {1.99685025e+06, 443318.53125}, {1.996842875e+06, 443323.9375}, {1.996842875e+06, 443323.9375}, {1.9968197232187183e+06, 443337.1989592995}, {1.9967845e+06, 443357.375}, {1.9967391211110454e+06, 443391.6950416795}, {1.99669025e+06, 443428.65625}, {1.996620125e+06, 443478.5625}, {1.99650475e+06, 443550.15625}, {1.996620125e+06, 443478.5625}, {1.99669025e+06, 443428.65625}, {1.9967391211110454e+06, 443391.6950416795}, {1.9967845e+06, 443357.375}, {1.9968197232187183e+06, 443337.1989592995}, {1.996842875e+06, 443323.9375}, {1.996842875e+06, 443323.9375}, {1.99685025e+06, 443318.53125}, {1.996842875e+06, 443323.9375}, {1.99685025e+06, 443318.53125}, {1.996842875e+06, 443323.9375}, {1.99685025e+06, 443318.53125}, {1.996842875e+06, 443323.9375}, {1.996842875e+06, 443323.9375}, {1.9968197232187183e+06, 443337.1989592995}, {1.9967845e+06, 443357.375}, {1.9967391211110454e+06, 443391.6950416795}, {1.99669025e+06, 443428.65625}, {1.996620125e+06, 443478.5625}, {1.99650475e+06, 443550.15625}}})

	shape := geom.T(geom.Polygon{
		{{1.992e+06, 432000}, {2.004e+06, 432000}, {2.004e+06, 444000}, {1.992e+06, 444000}, {1.992e+06, 432000}}})

	//drawLine(line, shape, nil, "difficultLine4.png")
	drawLine(line, nil, nil, "difficultLine4.png")
	intersection := Construct(line, shape, INTERSECTION)
	drawLine(line, shape, intersection, "difficultLine4.png")
}

func TestCentroid(t *testing.T) {
	shape := geom.T(geom.Polygon{
		{{0, 0}, {1, 0}, {2, 1}, {2, 2}, {1, 3}, {0, 3}, {-1, 2}, {-1, 1}, {0, 0}},
		{{0, 0.1}, {0.9, 2.7}, {1.9, 1.5}, {0.75, 0.1}, {0, 0.1}}})
	point := Centroid(shape)
	t.Log(point)
	drawShapes(shape, nil, point, "centroid.png")
}

func drawShapes(a, b, c geom.T, filename string) {
	f, err := os.Create(filename)
	if err != nil {
		panic(err)
	}
	carto.DrawShapes(f,
		[]color.NRGBA{{0, 0, 0, 255}, {0, 0, 0, 255}, {0, 0, 0, 255}},
		[]color.NRGBA{{255, 0, 0, 127}, {0, 255, 0, 127},
			{0, 0, 0, 200}},
		1, 8, a, b, c)
	f.Close()
}

func drawLine(a, b, c geom.T, filename string) {
	f, err := os.Create(filename)
	if err != nil {
		panic(err)
	}
	carto.DrawShapes(f,
		[]color.NRGBA{{255, 0, 0, 150}, {0, 0, 0, 127}, {0, 0, 255, 100}},
		[]color.NRGBA{{255, 0, 0, 0}, {0, 255, 0, 127},
			{0, 0, 0, 0}},
		4, 0, a, b, c)
	f.Close()
}

func drawLines(a, b, c geom.T, filename string) {
	f, err := os.Create(filename)
	if err != nil {
		panic(err)
	}
	carto.DrawShapes(f,
		[]color.NRGBA{{255, 0, 0, 255}, {0, 0, 0, 255}, {0, 0, 255, 255}},
		[]color.NRGBA{{255, 0, 0, 0}, {0, 255, 0, 0},
			{0, 0, 0, 0}},
		4, 8, a, b, c)
	f.Close()
}

func init() {
	rand.Seed(time.Now().UTC().UnixNano())
}

func RandomPoly(maxWidth, maxHeight float64, vertCnt int) geom.T {
	var result geom.Polygon
	result = make(geom.Polygon, 1)
	result[0] = make(geom.Ring, vertCnt)
	for i := 0; i < vertCnt-1; i++ {
		result[0][i] = geom.Point{rand.Float64() * maxWidth,
			rand.Float64() * maxHeight}
	}
	result[0][vertCnt-1] = result[0][0]
	return geom.T(result)
}

// Test operations on random (likely self-intersecting) polygons.
// In output images, intersection is red, xor is green, and union
// is grey (all colors are partially transparent). There should
// be no overlapping green or red areas, and every green or
// red area should be covered in grey. There should also be
// no grey areas that do not overlap with green or red.
func TestRandom(t *testing.T) {
	for i := 0; i < 10; i++ {

		// Generate random subject and clip polygons ...
		numVerticies := 100
		subj := RandomPoly(640, 480, numVerticies)
		clip := RandomPoly(640, 480, numVerticies)
		//subj := Paths([]Path{Path([]*IntPoint{
		//	{76, 351},{460, 441},{136, 71},{76, 351}})})
		//clip:= Paths([]Path{Path([]*IntPoint{
		//	{17, 230},{325, 5},{475, 30},{17, 230}})})

		clipTypes := map[string]Op{"intersection": INTERSECTION,
			"union": UNION, "xor": XOR}
		areas := make(map[string]float64)
		solutions := make(map[string]geom.T)

		for clipType, ct := range clipTypes {
			solutions[clipType] = Construct(subj, clip, ct)
			areas[clipType] = Area(solutions[clipType])
		}
		drawShapes(solutions["intersection"], solutions["xor"],
			solutions["union"], fmt.Sprintf("random_%v.png", i))

		if different(areas["union"], areas["intersection"]+areas["xor"]) {
			t.Logf("%v\t%10.1f%10.1f\tFail", i, areas["union"],
				areas["intersection"]+areas["xor"])
			t.Fail()
		} else {
			t.Logf("%v\t%10.1f%10.1f\tPass", i, areas["union"],
				areas["intersection"]+areas["xor"])
		}
	}
}

func different(a, b float64) bool {
	if math.Abs(a-b)/b > 0.001 {
		return true
	} else {
		return false
	}
}
